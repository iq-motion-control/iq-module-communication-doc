

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Vertiq 2306 220KV | Position Module &mdash; Python API 0.11.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Vertiq 8108 150KV | Speed Module" href="vertiq_8108_150.html" />
    <link rel="prev" title="Vertiq 2306 2200KV | Speed Module" href="vertiq_2306_2200.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/IQClear.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">UART Messaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../langs/arduino.html">Arduino API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../langs/cpp.html">C++ API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../langs/matlab.html">Matlab API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../langs/python.html">Python API</a></li>
</ul>
<p class="caption"><span class="caption-text">Modules</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="vertiq_2306_2200.html">Vertiq 2306 2200KV | Speed Module</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Vertiq 2306 220KV | Position Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#servo-firmware">Servo Firmware</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#multi-turn-angle-control">Multi Turn Angle Control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#arduino">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#c">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#matlab">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#python">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#message-table">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#brushless-drive">Brushless Drive</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#anticogging">Anticogging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id6">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#buzzer-control">Buzzer Control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id11">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id13">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id14">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id15">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hobby-input">Hobby Input</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id16">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id17">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id18">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id19">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id20">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#persistent-memory">Persistent Memory</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id21">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id22">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id23">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id24">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id25">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#power-monitor">Power Monitor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id26">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id27">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id28">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id29">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id30">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#serial-interface">Serial Interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id31">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id32">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id33">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id34">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id35">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#servo-input-parser">Servo Input Parser</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id36">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id37">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id38">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id39">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id40">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#system-control">System Control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id41">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id42">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id43">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id44">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id45">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#temperature-estimator">Temperature Estimator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id46">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id47">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id48">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id49">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id50">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#temperature-monitor-uc">Temperature Monitor UC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id51">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id52">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id53">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id54">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id55">Message Table</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#step-direction-firmware">Step Direction Firmware</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id56">Multi Turn Angle Control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id57">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id58">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id59">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id60">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id61">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id62">Brushless Drive</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id63">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id64">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id65">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id66">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id67">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id68">Anticogging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id69">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id70">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id71">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id72">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id73">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id74">Buzzer Control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id75">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id76">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id77">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id78">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id79">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id80">Persistent Memory</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id81">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id82">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id83">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id84">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id85">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id86">Power Monitor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id87">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id88">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id89">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id90">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id91">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id92">Serial Interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id93">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id94">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id95">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id96">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id97">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#step-direction-input">Step Direction Input</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id98">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id99">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id100">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id101">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id102">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id103">System Control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id104">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id105">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id106">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id107">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id108">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id109">Temperature Estimator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id110">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id111">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id112">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id113">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id114">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id115">Temperature Monitor UC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id116">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id117">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id118">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id119">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id120">Message Table</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#speed-firmware">Speed Firmware</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#propeller-motor-control">Propeller Motor Control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id121">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id122">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id123">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id124">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id125">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id126">Brushless Drive</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id127">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id128">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id129">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id130">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id131">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id132">Buzzer Control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id133">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id134">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id135">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id136">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id137">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#esc-propeller-input-parser">ESC Propeller Input Parser</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id138">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id139">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id140">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id141">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id142">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id143">Hobby Input</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id144">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id145">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id146">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id147">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id148">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id149">Persistent Memory</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id150">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id151">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id152">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id153">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id154">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id155">Power Monitor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id156">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id157">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id158">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id159">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id160">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id161">Serial Interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id162">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id163">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id164">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id165">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id166">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id167">System Control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id168">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id169">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id170">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id171">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id172">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id173">Temperature Estimator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id174">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id175">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id176">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id177">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id178">Message Table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id179">Temperature Monitor UC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id180">Arduino</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id181">C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id182">Matlab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id183">Python</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id184">Message Table</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vertiq_8108_150.html">Vertiq 8108 150KV | Speed Module</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Python API</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Vertiq 2306 220KV | Position Module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/modules/vertiq_2306_220.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="vertiq-2306-220kv-position-module">
<h1>Vertiq 2306 220KV | Position Module<a class="headerlink" href="#vertiq-2306-220kv-position-module" title="Permalink to this headline">¶</a></h1>
<div class="sidebar">
<p class="sidebar-title">Vertiq 2306 220KV</p>
<img alt="Vertiq 2306 200KV" src="../_images/IQ2306_220kv.png" />
</div>
<p>The IQ Vertiq 2306 220KV is an integrated motor
and controller with a wide range of position based applications. Its default firmware is the <strong>Servo Firmware</strong>. Its performance is comparable to or better
than other 2306 sized (NEMA 11, 28mm stepper) motors and can operate at any speed between -4,800 and
4800 RPM thanks to its sensored control. Its closedloop PID controller tracks targets across multiple revolutions,
making it ideal for applications with transmissions, both rotary and linear. This sits on top of
a voltage controller, which compensates for varying
input voltages. Finally, the core is a raw PWM controller. Any of the above controllers can be used by
the user. The IQ2306 Position Module has a built-in
rotary to linear calculation converter, which allows
the user to communicate to the firmware in native
linear units. The onboard minimum jerk trajectory
generator with 32 segment queue produces smooth,
human like motions with minimal computation and
communication overhead from the application controller.</p>
<p><a class="reference download internal" download="" href="../_downloads/2d65dad523d1bb4cc53c2be93ee72c1e/2306_position_datasheet.pdf"><code class="xref download docutils literal notranslate"><span class="pre">Position</span> <span class="pre">Module</span> <span class="pre">Datasheet</span></code></a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While the default firmware for the Vertiq 2306 220KV is the Servo Firmware, it also fully supports the following:</p>
<ul class="simple">
<li><p>Step Direction Firmware</p></li>
<li><p>Speed Firmware</p></li>
</ul>
</div>
<div class="section" id="servo-firmware">
<h2>Servo Firmware<a class="headerlink" href="#servo-firmware" title="Permalink to this headline">¶</a></h2>
<div class="section" id="multi-turn-angle-control">
<h3>Multi Turn Angle Control<a class="headerlink" href="#multi-turn-angle-control" title="Permalink to this headline">¶</a></h3>
<p>The Multi-turn Angle Controller is a non-wrapping, PID, position controller. It is capable of storing angular
to linear transmission information, mimicking a linear position controller. It also features a minimum jerk
trajectory generator. The controller has a 32 trajectory buffer so that transitions between trajectories are
seamless.</p>
<div class="section" id="arduino">
<h4>Arduino<a class="headerlink" href="#arduino" title="Permalink to this headline">¶</a></h4>
<p>To use Multi-turn Angle Controller in Arduino, ensure iq module communication.hpp is included. This
allows the creation of a MultiTurnAngleControlClient object. See Table 2 for available messages. All
message objects use the Short Name with a trailing underscore. All messages use the standard Get/Set/Save
functions.</p>
<p>A minimal working example for the MultiTurnAngleControlClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">MultiTurnAngleControlClient</span> <span class="nf">mult</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">mult</span><span class="p">.</span><span class="n">trajectory_angular_displacement_</span><span class="p">,</span><span class="mf">3.14f</span><span class="p">);</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">mult</span><span class="p">.</span><span class="n">trajectory_duration_</span><span class="p">,</span><span class="mf">0.5f</span><span class="p">);</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">mult</span><span class="p">.</span><span class="n">trajectory_angular_displacement_</span><span class="p">,</span><span class="mf">0.0f</span><span class="p">);</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">mult</span><span class="p">.</span><span class="n">trajectory_duration_</span><span class="p">,</span><span class="mf">0.5f</span><span class="p">);</span>
    <span class="nf">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="c">
<h4>C++<a class="headerlink" href="#c" title="Permalink to this headline">¶</a></h4>
<p>To use Multi-turn Angle Controller in C++, include multi turn angle control client.hpp. This allows the
creation of a MultiTurnAngleControlClient object. See Table 2 for available messages. All message objects
use the Short Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the MultiTurnAngleControlClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;multi_turn_angle_control_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">float</span> <span class="n">angle</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Multi-turn Angle Controller object with obj_id 0</span>
    <span class="n">MultiTurnAngleControlClient</span> <span class="n">angle_ctrl</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Multi-turn Angle Controller object</span>
    <span class="n">angle_ctrl</span><span class="p">.</span><span class="n">obs_angular_displacement_</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>
    <span class="n">angle_ctrl</span><span class="p">.</span><span class="n">ctrl_angle_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span><span class="mf">0.0f</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>
    <span class="c1">// Read response</span>
    <span class="n">angle</span> <span class="o">=</span> <span class="n">angle_ctrl</span><span class="p">.</span><span class="n">ctrl_angle_</span><span class="p">.</span><span class="n">get_reply</span><span class="p">();</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="matlab">
<h4>Matlab<a class="headerlink" href="#matlab" title="Permalink to this headline">¶</a></h4>
<p>To use Multi-turn Angle Controller in Matlab, all IQ communication code must be included in your path.
This allows the creation of a MultiTurnAngleControlClient object. See Table 2 for available messages. All
message strings use the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the MultiTurnAngleControlClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a MultiTurnAngleControlClient object with obj_id 0</span><span class="w"></span>
<span class="n">angle_ctrl</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MultiTurnAngleControlClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the MultiTurnAngleControlClient object</span><span class="w"></span>
<span class="n">velocity_filtered</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">angle_ctrl</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>’<span class="n">obs_angular_displacement</span>’<span class="p">);</span><span class="w"></span>
<span class="n">angle_ctrl</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">ctrl_angle</span>’<span class="p">,</span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="python">
<h4>Python<a class="headerlink" href="#python" title="Permalink to this headline">¶</a></h4>
<p>To use the Multi-Turn Angle Control Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Multi-Turn Angle Control Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Multi-Turn Angle Control Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">firmware</span><span class="o">=</span><span class="s2">&quot;servo&quot;</span><span class="p">)</span>   <span class="c1"># Servo Firmware uses this client</span>

<span class="c1"># Set the trajectory for the motor to complete 1 full rotation</span>
<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;multi_turn_angle_control&quot;</span><span class="p">,</span> <span class="s2">&quot;trajectory_angular_displacement&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

<span class="c1"># Sets trajectory duration for 2 seconds</span>
<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;multi_turn_angle_control&quot;</span><span class="p">,</span> <span class="s2">&quot;duration&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="message-table">
<h4>Message Table<a class="headerlink" href="#message-table" title="Permalink to this headline">¶</a></h4>
<p>Type ID 59 | Multi-turn Angle Controller</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 4%" />
<col style="width: 18%" />
<col style="width: 9%" />
<col style="width: 6%" />
<col style="width: 10%" />
<col style="width: 53%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>ctrl_mode</p></td>
<td><p>get</p></td>
<td><p>int8</p></td>
<td><p>enum</p></td>
<td><p>no_change = -1, brake=0, coast=1, pwm=2, volts=3, velocity=4, angle=5, trajectory=6</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>ctrl_brake</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Shorts motor phases, slows motor down dissipating energy in motor</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>ctrl_coast</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Disables all drive circuitry, motor passively coasts</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>ctrl_angle</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td><p>Angular location command</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>ctrl_velocity</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>rad/s</p></td>
<td><p>Angular velocity command</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>angle_Kp</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>V/rad</p></td>
<td><p>Proportional gain</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>angle_Ki</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>V/(rad*s)</p></td>
<td><p>Integral gain</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>angle_Kd</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>V/(rad/s)</p></td>
<td><p>Derivative gain</p></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>timeout</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>s</p></td>
<td><p>The controller must receive a message within this time otherwise it is set to coast mode</p></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>ctrl_pwm</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>pwm</p></td>
<td><p>Spins motor with this throttle [-1, 1]</p></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p>ctrl_volts</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>Spins motor with this voltage</p></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p>obs_angular_displacement</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td><p>Observed angular location</p></td>
</tr>
<tr class="row-even"><td><p>12</p></td>
<td><p>obs_angular_velocity</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>rad/s</p></td>
<td><p>Observed angular velocity</p></td>
</tr>
<tr class="row-odd"><td><p>13</p></td>
<td><p>meter_per_rad</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>m/rad</p></td>
<td><p>Transmission between angular and linear motion</p></td>
</tr>
<tr class="row-even"><td><p>14</p></td>
<td><p>ctrl_linear_displacement</p></td>
<td><p>get, set,</p></td>
<td><p>float</p></td>
<td><p>m</p></td>
<td><p>Linear equivalent to ctrl_angle</p></td>
</tr>
<tr class="row-odd"><td><p>15</p></td>
<td><p>ctrl_linear_velocity</p></td>
<td><p>get, set,</p></td>
<td><p>float</p></td>
<td><p>m/s</p></td>
<td><p>Linear equivalent to ctrl_velocity</p></td>
</tr>
<tr class="row-even"><td><p>16</p></td>
<td><p>obs_linear_displacement</p></td>
<td><p>get, set,</p></td>
<td><p>float</p></td>
<td><p>m</p></td>
<td><p>Observed linear location</p></td>
</tr>
<tr class="row-odd"><td><p>17</p></td>
<td><p>obs_linear_velocity</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>m/s</p></td>
<td><p>Observed linear velocity</p></td>
</tr>
<tr class="row-even"><td><p>18</p></td>
<td><p>angular_speed_max</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>rad/s</p></td>
<td><p>The controller will never attempt to exceed this speed</p></td>
</tr>
<tr class="row-odd"><td><p>19</p></td>
<td><p>trajectory_angular_displacement</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td><p>Final absolute displacement of trajectory.</p></td>
</tr>
<tr class="row-even"><td><p>20</p></td>
<td><p>trajectory_angular_velocity</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>rad/s</p></td>
<td><p>Final velocity of the trajectory. Defaults to 0.</p></td>
</tr>
<tr class="row-odd"><td><p>21</p></td>
<td><p>trajectory_angular_acceleration</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><div class="math notranslate nohighlight">
\[rad/s^2\]</div>
</td>
<td><p>Final acceleration of the trajectory. Defaults to 0.</p></td>
</tr>
<tr class="row-even"><td><p>22</p></td>
<td><p>trajectory_duration</p></td>
<td><p>set</p></td>
<td><p>float</p></td>
<td><p>s</p></td>
<td><p>Duration of trajectory. Trajectory is executed or queued once this is sent.</p></td>
</tr>
<tr class="row-odd"><td><p>23</p></td>
<td><p>trajectory_linear_displacement</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>m</p></td>
<td><p>Final absolute displacement of trajectory.</p></td>
</tr>
<tr class="row-even"><td><p>24</p></td>
<td><p>trajectory_linear_velocity</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>m/s</p></td>
<td><p>Final velocity of the trajectory. Defaults to 0.</p></td>
</tr>
<tr class="row-odd"><td><p>25</p></td>
<td><p>trajectory_linear_acceleration</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><div class="math notranslate nohighlight">
\[m/s^2\]</div>
</td>
<td><p>Final acceleration of the trajectory. Defaults to 0.</p></td>
</tr>
<tr class="row-even"><td><p>26</p></td>
<td><p>trajectory_average_speed</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><div class="math notranslate nohighlight">
\[m/s^2\]</div>
</td>
<td><p>Average speed of a trajectory.  Trajectory is executed or queued once this is sent. Must be $&gt;0$.</p></td>
</tr>
<tr class="row-odd"><td><p>27</p></td>
<td><p>trajectory_queue_mode</p></td>
<td><p>get, set, save</p></td>
<td><p>int8</p></td>
<td><div class="math notranslate nohighlight">
\[m/s^2\]</div>
</td>
<td><p>append=0, overwrite=1</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="brushless-drive">
<h3>Brushless Drive<a class="headerlink" href="#brushless-drive" title="Permalink to this headline">¶</a></h3>
<p>Brushless Drive is the low level driver of the motor’s phase voltage.</p>
<div class="section" id="id1">
<h4>Arduino<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>To use Brushless Drive in Arduino, ensure iq module communication.hpp is included. This allows the creation of a BrushlessDriveClient object.
See Table 3 for available messages. All message objects use the Short
Name with a trailing underscore. All messages use the standard <code class="docutils literal notranslate"><span class="pre">Get/Set/Save</span></code> functions.</p>
<p>A minimal working example for the BrushlessDriveClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communicaiton.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">BrushlessDriveClient</span> <span class="nf">mot</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">mot</span><span class="p">.</span><span class="n">drive_spin_volts_</span><span class="p">,</span><span class="mf">0.1f</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h4>C++<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>To use Brushless Drive in C++, include brushless drive client.hpp. This allows the creation of a <code class="docutils literal notranslate"><span class="pre">BrushlessDriveClient</span></code> object.
See Table 3 for available messages. All message objects use the Short Name with a trailing underscore. All messages use the standard <code class="docutils literal notranslate"><span class="pre">Get/Set/Save</span></code> functions.</p>
<p>A minimal working example for the BrushlessDriveClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;propeller_motor_control_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">float</span> <span class="n">voltage</span> <span class="o">=</span> <span class="mf">3.0f</span><span class="p">;</span> <span class="c1">// volts</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>

<span class="c1">// Make a communication interface object</span>
<span class="c1">// This is what creates and parses packets</span>
<span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

<span class="c1">// Make a Temperature Estimator Client object with obj_id 0</span>
<span class="n">BrushlessDriveClient</span> <span class="n">brushless</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="c1">// Drives the motor at 3 Volts</span>
<span class="n">brushless</span><span class="p">.</span><span class="n">drive_spin_volts_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="n">voltage</span><span class="p">);</span>

<span class="c1">// Insert code for interfacing with hardware here</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h4>Matlab<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<p>To use Brushless Drive Controller in Matlab, all IQ communication code must be included in your path.
This allows the creation of a BrushlessDriveClient object. See Table 2 for available messages. All
message strings use the Short Names. All messages use the standard <code class="docutils literal notranslate"><span class="pre">Get/Set/Save</span></code> functions.</p>
<p>A minimal working example for the BrushlessDriveClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a BrushlessDriveClient object with obj_id 0</span><span class="w"></span>
<span class="n">drive</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">BrushlessDriveClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the BrushlessDriveClient object</span><span class="w"></span>
<span class="n">drive</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">drive_spin_volts</span>’<span class="p">,</span><span class="mf">3.0</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h4>Python<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>To use the Brushless Drive Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Brushless Drive Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the BrushlessDriveClient is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;brushless_drive&quot;</span><span class="p">,</span> <span class="s2">&quot;drive_spin_volts&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># Spins motor at 5 volts</span>
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h4>Message Table<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<p>Type ID 50 | Brushless Drive</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 4%" />
<col style="width: 10%" />
<col style="width: 8%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 65%" />
<col style="width: 3%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>drive_mode</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td></td>
<td><p>0 = phase_pwm, 1 = phase_volts, 2 = spin_pwm, 3 = spin_volts, 4 = brake, 5 = coast</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>drive_phase_pwm</p></td>
<td><p>set</p></td>
<td><p>float</p></td>
<td><p>pwm</p></td>
<td><p>Open loop (gimbal) mode with this trottle [-1, 1].  Use with phase_angle.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>drive_phase_volts</p></td>
<td><p>set</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>Open loop (gimbal) mode with this voltage.  Use with phase_angle.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>drive_spin_pwm</p></td>
<td><p>set</p></td>
<td><p>float</p></td>
<td><p>pwm</p></td>
<td><p>Spins motor with this throttle [-1, 1]</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>drive_spin_volts</p></td>
<td><p>set</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>Spins motor with this voltage</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>drive_brake</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Shorts motor phases, slows motor down dissipating energy in motor</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>drive_coast</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Disables all drive circuitry, motor passively coasts</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>drive_angle_offset</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td><p>Analogous to motor timing. This is internally computed by the motor.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>drive_pwm</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>pwm</p></td>
<td><p>The applied pwm after all computation and limiting [-1, 1]</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>drive_volts</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>The applied pwm after all computation and limiting</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p>mech_lead_angle</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p>obs_supply_volts</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>Observed supply voltage</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>12</p></td>
<td><p>obs_angle</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td><p>Observed motor angle</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>13</p></td>
<td><p>obs_velocity</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>rad/s</p></td>
<td><p>Observed motor velocity</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>14</p></td>
<td><p>motor_pole_pairs</p></td>
<td><p>get, set, save</p></td>
<td><p>uint16</p></td>
<td></td>
<td><p>Number of motor pole pairs (magnets/2)</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>15</p></td>
<td><p>motor_emf_shape</p></td>
<td><p>get, set, save</p></td>
<td><p>uint8</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>16</p></td>
<td><p>permute_wires</p></td>
<td><p>get, set, save</p></td>
<td><p>uint8</p></td>
<td><p>bool</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>17</p></td>
<td><p>calibration_angle</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>18</p></td>
<td><p>lead_time</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>s</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>19</p></td>
<td><p>commutation_hz</p></td>
<td><p>get, set, save</p></td>
<td><p>uint32</p></td>
<td><p>Hz</p></td>
<td><p>Frequency of commutation.  Higher frequencies run faster and more efficient, but may not give the controller enough computation time.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>20</p></td>
<td><p>phase_angle</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td><p>Angle used for open loop (gimbal) mode. Use with drive_phase_pwm or drive_phase_volts</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>32</p></td>
<td><p>motor_Kv</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>RPM/V</p></td>
<td><p>Motor’s voltage constant</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>33</p></td>
<td><p>motor_R_ohm</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>ohm</p></td>
<td><p>Motor’s resistance</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>34</p></td>
<td><p>motor_I_max</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>A</p></td>
<td><p>Max allowable motor current</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>35</p></td>
<td><p>volts_limit</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>Max regen voltage</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>36</p></td>
<td><p>est_motor_amps</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>A</p></td>
<td><p>Estimated motor amps</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>37</p></td>
<td><p>est_motor_torque</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>Nm</p></td>
<td><p>Estimated motor torque</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>38</p></td>
<td><p>motor_redline_start</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>rad/s</p></td>
<td><p>Speed at which motor begins to derate</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>39</p></td>
<td><p>motor_redline_end</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>rad/s</p></td>
<td><p>Speed at which the motor is fully derated</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>40</p></td>
<td><p>motor_l</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>H</p></td>
<td><p>Cross inductance</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>41</p></td>
<td><p>derate</p></td>
<td><p>get</p></td>
<td><p>int32</p></td>
<td><p>PU fix16</p></td>
<td><p>Amount of derating.  No derate = 65536, full derate = 0</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>42</p></td>
<td><p>i_soft_start</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>A</p></td>
<td><p>Current at which motor begins to derate</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>43</p></td>
<td><p>i_soft_end</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>A</p></td>
<td><p>Current at which the motor is fully derated</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="anticogging">
<h3>Anticogging<a class="headerlink" href="#anticogging" title="Permalink to this headline">¶</a></h3>
<p>Anticogging is the process of electronically canceling out cogging torque of a motor. Each motor is loaded
with its unique cog information. This class allows enabling and disabling the anticogging process. Though
this class can also manipulate the cog information it is not recommended to manipulate or erase this data
as it is unrecoverable.</p>
<div class="section" id="id6">
<h4>Arduino<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>To use the Anticogging in Arduino, ensure iq module communication.hpp is included. This allows the
creation of a AnticoggingClient object. See Table below for available messages. All message objects use the
Short Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the AnticoggingClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>
<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>

<span class="n">BrushlessDriveClient</span> <span class="nf">mot</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="n">AnticoggingClient</span> <span class="nf">cog</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">mot</span><span class="p">.</span><span class="n">drive_spin_volts_</span><span class="p">,</span><span class="mf">0.0f</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Spin the motor with your hand and feel Anticogging turning on and off</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">cog</span><span class="p">.</span><span class="n">is_enabled_</span><span class="p">,(</span><span class="kr">uint8_t</span><span class="p">)</span><span class="mi">1</span><span class="p">);</span>
    <span class="nf">delay</span><span class="p">(</span><span class="mi">2000</span><span class="p">);</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">cog</span><span class="p">.</span><span class="n">is_enabled_</span><span class="p">,(</span><span class="kr">uint8_t</span><span class="p">)</span><span class="mi">0</span><span class="p">);</span>
    <span class="nf">delay</span><span class="p">(</span><span class="mi">2000</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h4>C++<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<p>To use the Anticogging client in C++, include anticogging client.hpp. This allows the creation of an
AnticoggingClient object. See Table below for available messages. All message objects use the Short Name with a
trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the AnticoggingClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;anticogging_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a ESC Propeller Input Parser object with obj_id 0</span>
    <span class="n">AnticoggingClient</span> <span class="n">cog</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the ESC Propeller Input Parser object</span>
    <span class="n">cog</span><span class="p">.</span><span class="n">is_enabled_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h4>Matlab<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<p>To use the Anticogging client in Matlab, all IQ communication code must be included in your path. This
allows the creation of a AnticoggingClient object. See Table below for available messages. All message strings
use the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the AnticoggingClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make an AnticoggingClient object with obj_id 0</span><span class="w"></span>
<span class="n">cog</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">AnticoggingClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the AnticoggingClient object</span><span class="w"></span>
<span class="n">cog</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">is_enabled</span>’<span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id9">
<h4>Python<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<p>To use the Anticogging Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Anticogging Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Anticogging Client is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">firmware</span><span class="o">=</span><span class="s2">&quot;servo&quot;</span><span class="p">)</span>

<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;anticogging&quot;</span><span class="p">,</span> <span class="s2">&quot;is_enabled&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Turns on Anticogging</span>
</pre></div>
</div>
</div>
<div class="section" id="id10">
<h4>Message Table<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h4>
<p>Type ID 71 | Anticogging</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 5%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 6%" />
<col style="width: 9%" />
<col style="width: 62%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>table_size</p></td>
<td><p>get</p></td>
<td><p>uint16</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>Size of the anticogging table</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>is_data_valid</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>bool</p></td>
<td><p>Indicates if the cog information is valid.  is_enabled must be called first to check the cog information.</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>is_enabled</p></td>
<td><p>get, set, save</p></td>
<td><p>uint8</p></td>
<td><p>bool</p></td>
<td><p>Indicates if anticogging is running.  This will stay 0/false if the is_data_valid field is 0/false.</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>erase</p></td>
<td><p>set</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>Erases the cog information.  This is not recommended.</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>left_shift</p></td>
<td><p>get, set, save</p></td>
<td><p>uint8</p></td>
<td><div class="math notranslate nohighlight">
\[*2^x\]</div>
</td>
<td><p>Anticog multiplier.  Modification is not recommended.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="buzzer-control">
<h3>Buzzer Control<a class="headerlink" href="#buzzer-control" title="Permalink to this headline">¶</a></h3>
<p>The Buzzer Control handles all beeps and songs played by the motor. The controls mimic standard MIDI
commands allowing simple translation from MIDI to Buzzer Control commands. The volume max parameter
controls the absolute volume across all notes, measured in volts. To play a note on the buzzer, set the
frequency by sending a ’hz’ command, set a relative volume by sending a ’volume’ command, set a note
length by sending a ’duration’ command, and finally put the controller in note mode by sending ’ctrl note’.</p>
<div class="section" id="id11">
<h4>Arduino<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h4>
<p>To use the Buzzer Control in Arduino, ensure iq module communication.hpp is included. This allows the
creation of a BuzzerControlClient object. See Table 5 for available messages. All message objects use the
Short Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the BuzzerControlClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">BuzzerControlClient</span> <span class="nf">buz</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">buz</span><span class="p">.</span><span class="n">hz_</span><span class="p">,(</span><span class="kr">uint16_t</span><span class="p">)</span><span class="mi">1000</span><span class="p">);</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">buz</span><span class="p">.</span><span class="n">volume_</span><span class="p">,(</span><span class="kr">uint8_t</span><span class="p">)</span><span class="mi">127</span><span class="p">);</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">buz</span><span class="p">.</span><span class="n">duration_</span><span class="p">,(</span><span class="kr">uint16_t</span><span class="p">)</span><span class="mi">500</span><span class="p">);</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">buz</span><span class="p">.</span><span class="n">ctrl_note_</span><span class="p">);</span>
    <span class="nf">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id12">
<h4>C++<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p>To use the Buzzer Control in C++, include buzzer control client.hpp. This allows the creation of a
BuzzerControlClient object. See Table 5 for available messages. All message objects use the Short Name with a
trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the BuzzerControlClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;buzzer_control_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Buzzer Control object with obj_id 0</span>
    <span class="n">BuzzerControlClient</span> <span class="n">buz</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Buzzer Control object</span>
    <span class="n">buz</span><span class="p">.</span><span class="n">hz_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">440</span><span class="p">);</span> <span class="c1">// A4</span>
    <span class="n">buz</span><span class="p">.</span><span class="n">volume_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">127</span><span class="p">);</span> <span class="c1">// Max volume</span>
    <span class="n">buz</span><span class="p">.</span><span class="n">duration_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span> <span class="c1">// 500ms</span>
    <span class="n">buz</span><span class="p">.</span><span class="n">ctrl_note_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">);</span> <span class="c1">// Note mode</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id13">
<h4>Matlab<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h4>
<p>To use the Buzzer Contol in Matlab, all IQ communication code must be included in your path. This allows
the creation of a BuzzerControlClient object. See Table 5 for available messages. All message strings use
the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the BuzzerControlClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a BuzzerControlClient object with obj_id 0</span><span class="w"></span>
<span class="n">buz</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">BuzzerControlClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the BuzzerControlClient object</span><span class="w"></span>
<span class="n">buz</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">hz</span>’<span class="p">,</span><span class="mi">440</span><span class="p">);</span><span class="w"> </span><span class="c">% A4</span><span class="w"></span>
<span class="n">buz</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="nb">volume</span>’<span class="p">,</span><span class="mi">127</span><span class="p">);</span><span class="w"> </span><span class="c">% Max volume</span><span class="w"></span>
<span class="n">buz</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="nb">duration</span>’<span class="p">,</span><span class="mi">500</span><span class="p">);</span><span class="w"> </span><span class="c">% 500ms</span><span class="w"></span>
<span class="n">buz</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">ctrl_note</span>’<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id14">
<h4>Python<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h4>
<p>To use the Buzzer Control Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Buzzer Control Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Buzzer Control Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;buzzer_control&quot;</span><span class="p">,</span> <span class="s2">&quot;hz&quot;</span><span class="p">,</span> <span class="mi">440</span><span class="p">)</span>         <span class="c1"># A4</span>
<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;buzzer_control&quot;</span><span class="p">,</span> <span class="s2">&quot;volume&quot;</span><span class="p">,</span> <span class="mi">127</span><span class="p">)</span>     <span class="c1"># Max Volume</span>
<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;buzzer_control&quot;</span><span class="p">,</span> <span class="s2">&quot;duration&quot;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c1"># 1000ms</span>
<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;buzzer_control&quot;</span><span class="p">,</span> <span class="s2">&quot;ctrl_note&quot;</span><span class="p">)</span>       <span class="c1"># Start the Note</span>
</pre></div>
</div>
</div>
<div class="section" id="id15">
<h4>Message Table<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h4>
<p>Type ID 61 | Buzzer Control</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 7%" />
<col style="width: 10%" />
<col style="width: 13%" />
<col style="width: 9%" />
<col style="width: 6%" />
<col style="width: 55%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>ctrl_mode</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>enum</p></td>
<td><p>no_change = -1, brake=0, coast=1, note=2, song=3</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>ctrl_brake</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Shorts motor phases, slows motor down dissipating energy in motor</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>ctrl_coast</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Disables all drive circuitry, motor passively coasts</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>ctrl_note</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Must have sent a ‘hz’ and ‘volume’ first</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>volume_max</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>Uses this voltage command for maximum volume</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>hz</p></td>
<td><p>get, set</p></td>
<td><p>uint16</p></td>
<td><p>hz</p></td>
<td><p>Frequency of the note</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>volume</p></td>
<td><p>get, set</p></td>
<td><p>uint8</p></td>
<td><p>0-127</p></td>
<td><p>Individual note volume as fraction of 127</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>duration</p></td>
<td><p>get, set</p></td>
<td><p>uint16</p></td>
<td><p>ms</p></td>
<td><p>Note length.  Assumed max (65535 ms) if not sent.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="hobby-input">
<h3>Hobby Input<a class="headerlink" href="#hobby-input" title="Permalink to this headline">¶</a></h3>
<p>The Hobby Input gives the module the ability to read in a variety of hobby communication protocols.
Supported protocols are standard 1-2ms PWM, OneShot125, OneShot42, MultiShot, and DShot (150 -
1200). The protocols are autodetected by default, but can be set to accept a single specific protocol. The
values read by the Hobby Input are fed into a Parser object, such as the Servo Parser or the ESC Parser.</p>
<div class="section" id="id16">
<h4>Arduino<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h4>
<p>To use Hobby Input in Arduino, ensure iq module communication.hpp is included. This allows the creation
of a HobbyInputClient object. See Table 7 for available messages. All message objects use the Short Name
with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the HobbyInputClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">HobbyInputClient</span> <span class="nf">hin</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">hin</span><span class="p">.</span><span class="n">allowed_protocols_</span><span class="p">,(</span><span class="kr">uint8_t</span><span class="p">)</span><span class="mi">6</span><span class="p">);</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">hin</span><span class="p">.</span><span class="n">allowed_protocols_</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id17">
<h4>C++<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h4>
<p>To use Hobby Input in C++, include hobby input client.hpp. This allows the creation of a HobbyInputClient
object. See Table 7 for available messages. All message objects use the Short Name with a trailing underscore.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the HobbyInputClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;hobby_input_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Hobby Input object with obj_id 0</span>
    <span class="n">HobbyInputClient</span> <span class="n">hin</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Hobby Input object</span>
    <span class="n">hin</span><span class="p">.</span><span class="n">allowed_protocols_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="c1">// Set the protocol to OneShot42</span>
    <span class="n">hin</span><span class="p">.</span><span class="n">allowed_protocols_</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id18">
<h4>Matlab<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h4>
<p>To use Hobby Input in Matlab, all IQ communication code must be included in your path. This allows the
creation of a Hobby Input object. See Table 7 for available messages. All message strings use the Short
Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the HobbyInputClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a HobbyInputClient object with obj_id 0</span><span class="w"></span>
<span class="n">hin</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">HobbyInputClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the EscPropellerInputParserClient object</span><span class="w"></span>
<span class="n">hin</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">allowed_protocols</span>’<span class="p">,</span><span class="mi">3</span><span class="p">);</span><span class="w"></span>
<span class="n">hin</span><span class="p">.</span><span class="n">save</span><span class="p">(</span>’<span class="n">allowed_protocols</span>’<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id19">
<h4>Python<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h4>
<p>To use the Hobby Input Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Hobby Input Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Hobby Input Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;hobby_input&quot;</span><span class="p">,</span> <span class="s2">&quot;allowed_protocols&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>   <span class="c1"># Set the protocol to MultiShot</span>
<span class="n">vertiq</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;hobby_input&quot;</span><span class="p">,</span> <span class="s2">&quot;allowed_protocols&quot;</span><span class="p">)</span>     <span class="c1"># Save the protocol</span>
</pre></div>
</div>
</div>
<div class="section" id="id20">
<h4>Message Table<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h4>
<p>Type ID 76 | Hobby Input</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 6%" />
<col style="width: 15%" />
<col style="width: 13%" />
<col style="width: 9%" />
<col style="width: 5%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>allowed_protocols</p></td>
<td><p>get, set, save</p></td>
<td><p>uint8</p></td>
<td><p>enum</p></td>
<td><p>Standard PWM = 1, OneShot125 = 2, OneShot42 = 3, MultiShot = 4,</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>protocol</p></td>
<td><p>get, set, save</p></td>
<td><p>uint8</p></td>
<td><p>enum</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="persistent-memory">
<h3>Persistent Memory<a class="headerlink" href="#persistent-memory" title="Permalink to this headline">¶</a></h3>
<p>The Persistent Memory class controls the non-volatile memory. You can use this class to revert the motor
to factory defaults.</p>
<div class="section" id="id21">
<h4>Arduino<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h4>
<p>To use Persistent Memory in Arduino, ensure iq module communication.hpp is included. This allows the
creation of a PersistentMemoryClient object. See Table 13 for available messages. All message objects use
the Short Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the PersistentMemoryClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">PersistentMemoryClient</span> <span class="nf">mem</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">mem</span><span class="p">.</span><span class="n">revert_to_default_</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id22">
<h4>C++<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h4>
<p>To use Persistent Memory in C++, include persistent memory client.hpp. This allows the creation of a
PersistentMemoryClient object. See Table 13 for available messages. All message objects use the Short
Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the PersistentMemoryClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;persistent_memory_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Persistent Memory object with obj_id 0</span>
    <span class="n">PersistentMemoryClient</span> <span class="n">mem</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Persistent Memory object</span>
    <span class="n">mem</span><span class="p">.</span><span class="n">revert_to_default_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id23">
<h4>Matlab<a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h4>
<p>To use Persistent Memory in Matlab, all IQ communication code must be included in your path. This allows
the creation of a PersistentMemoryClient object. See Table 13 for available messages. All message strings
use the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the PersistentMemoryClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a PersistentMemoryClient object with obj_id 0</span><span class="w"></span>
<span class="n">mem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">PersistentMemoryClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the PersistentMemoryClient object</span><span class="w"></span>
<span class="n">mem</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">revert_to_default</span>’<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id24">
<h4>Python<a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h4>
<p>To use the Persistent Memory Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Persistent Memory Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Persistent Memory Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;persistent_memory&quot;</span><span class="p">,</span> <span class="s2">&quot;revert_to_default&quot;</span><span class="p">)</span>  <span class="c1"># erases saved values except for factory defaults</span>
</pre></div>
</div>
</div>
<div class="section" id="id25">
<h4>Message Table<a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h4>
<p>Type ID 11 | Persistent Memory</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 5%" />
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 8%" />
<col style="width: 4%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>erase</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Erases all saved values including calibration data and product key.  Highly not recommended.</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>revert_to_default</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Erases all saved values except for those set in factory.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="power-monitor">
<h3>Power Monitor<a class="headerlink" href="#power-monitor" title="Permalink to this headline">¶</a></h3>
<p>The Power Monitor measures the power coming into the module. It reports input voltage and current as
well as calculates power and energy consumed. A built in low pass filter with adjustable cutoff frequency
smooths these values.</p>
<div class="section" id="id26">
<h4>Arduino<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h4>
<p>To use Power Monitor in Arduino, ensure iq module communication.hpp is included. This allows the creation
of a PowerMonitorClient object. See Table 9 for available messages. All message objects use the Short Name
with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the PowerMonitorClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">PowerMonitorClient</span> <span class="nf">pwr</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>

    <span class="c1">// Initialize Serial (for displaying information on the terminal)</span>
    <span class="nf">Serial</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">float</span> <span class="n">voltage</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ser</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">pwr</span><span class="p">.</span><span class="n">volts_</span><span class="p">,</span><span class="n">voltage</span><span class="p">))</span>
    <span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">voltage</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id27">
<h4>C++<a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h4>
<p>To use Power Monitor in C++, include power monitor client.hpp. This allows the creation of a
PowerMonitorClient object. See Table 9 for available messages. All message objects use the Short Name with a trailing
underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the PowerMonitorClient is:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;power_monitor_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">float</span> <span class="n">volts</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Power Monitor object with obj_id 0</span>
    <span class="n">PowerMontitorClient</span> <span class="n">pwr</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Power Monitor object</span>
    <span class="n">pwr</span><span class="p">.</span><span class="n">volts_</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>
    <span class="c1">// Read response</span>
    <span class="n">volts</span> <span class="o">=</span> <span class="n">pwr</span><span class="p">.</span><span class="n">volts_</span><span class="p">.</span><span class="n">get_reply</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id28">
<h4>Matlab<a class="headerlink" href="#id28" title="Permalink to this headline">¶</a></h4>
<p>To use Power Monitor in Matlab, all IQ communication code must be included in your path. This allows
the creation of a PowerMonitorClient object. See Table 9 for available messages. All message strings use
the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the PowerMonitorClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a PowerMontitorClient object with obj_id 0</span><span class="w"></span>
<span class="n">pwr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">PowerMontitorClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the PowerMontitorClient object</span><span class="w"></span>
<span class="n">volts</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pwr</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>’<span class="n">volts</span>’<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id29">
<h4>Python<a class="headerlink" href="#id29" title="Permalink to this headline">¶</a></h4>
<p>To use the Power Monitor Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Power Monitor Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Power Monitor Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">volts</span> <span class="o">=</span> <span class="n">vertiq</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;power_monitor&quot;</span><span class="p">,</span> <span class="s2">&quot;volts&quot;</span><span class="p">)</span>  <span class="c1"># returns the input voltage to module</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Voltage coming into module: </span><span class="si">{</span><span class="n">volts</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id30">
<h4>Message Table<a class="headerlink" href="#id30" title="Permalink to this headline">¶</a></h4>
<p>Type ID 69 | Power Monitor</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 8%" />
<col style="width: 14%" />
<col style="width: 16%" />
<col style="width: 11%" />
<col style="width: 7%" />
<col style="width: 46%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>volts</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>Input voltage to module</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>amps</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>A</p></td>
<td><p>Input amperage to module</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>watts</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>W</p></td>
<td><p>Input wattage to module</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>joules</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>J</p></td>
<td><p>Total energy consumed by module</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>reset_joules</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Sets joules to zero</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>filter_fs</p></td>
<td><p>get</p></td>
<td><p>uint32</p></td>
<td><p>Hz</p></td>
<td><p>Low pass filter sample frequency</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>filter_fc</p></td>
<td><p>get, set, save</p></td>
<td><p>uint32</p></td>
<td><p>Hz</p></td>
<td><p>Low pass filter cutoff frequency</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>volts_raw</p></td>
<td><p>get</p></td>
<td><p>uint16</p></td>
<td><p>bit</p></td>
<td><p>ADC value for the voltage measurement</p></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>amps_raw</p></td>
<td><p>get</p></td>
<td><p>uint16</p></td>
<td><p>bit</p></td>
<td><p>ADC value for the current measurement</p></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>volts_gain</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>V/bit</p></td>
<td><p>Gain for the ADC to voltage conversion</p></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p>amps_gain</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>A/bit</p></td>
<td><p>Gain for the ADC to current conversion</p></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p>amps_bias</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>bit</p></td>
<td><p>Offset bias for the ADC to current conversion</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="serial-interface">
<h3>Serial Interface<a class="headerlink" href="#serial-interface" title="Permalink to this headline">¶</a></h3>
<p>The Serial client allows the user to change settings related to the serial communication interface, namely
the baud rate. The set function of the baud rate behaves as both a set then a save. This allows the user to
set and save using the initial baud rate, rather than having to disconnect and reconnect using the new baud
rate in order to send a save. For this reason, the standard save function for the baud rate is disabled.</p>
<div class="section" id="id31">
<h4>Arduino<a class="headerlink" href="#id31" title="Permalink to this headline">¶</a></h4>
<p>To use Serial Interface in Arduino, ensure iq module communication.hpp is included. This allows the creation
of a SerialInterfaceClient object. See Table 8 for available messages. All message objects use the Short Name
with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the SerialInterfaceClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">SerialInterfaceClient</span> <span class="nf">sic</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">sic</span><span class="p">.</span><span class="n">baud_rate_</span><span class="p">,(</span><span class="kr">uint32_t</span><span class="p">)</span><span class="mi">9600</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To start from 9600 baud and reset the baud back to the default 115200, use:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">SerialInterfaceClient</span> <span class="nf">sic</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="mi">9600</span><span class="p">);</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">sic</span><span class="p">.</span><span class="n">baud_rate_</span><span class="p">,(</span><span class="kr">uint32_t</span><span class="p">)</span><span class="mi">115200</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id32">
<h4>C++<a class="headerlink" href="#id32" title="Permalink to this headline">¶</a></h4>
<p>To use Serial Interface in C++, include serial interface client.hpp. This allows the
creation of a SerialInterfaceClient object. See Table 8 for available messages. All
message objects use the Short Name with a trailing underscore.</p>
<p>A minimal working example for the SerialInterfaceClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;serial_interface_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">uint32_t</span> <span class="n">baud_rate</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Serial Interface object with obj_id 0</span>
    <span class="n">SerialInterfaceClient</span> <span class="n">serial_interface</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Serial Interface object</span>
    <span class="n">serial_interface</span><span class="p">.</span><span class="n">baud_rate_</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>
    <span class="c1">// baud_rate = serial_interface.baud_rate_.get_reply();</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id33">
<h4>Matlab<a class="headerlink" href="#id33" title="Permalink to this headline">¶</a></h4>
<p>To use Serial Interface in Matlab, all IQ communication code must be included in your path. This allows
the creation of a SerialInterfaceClient object. See Table 8 for available messages. All message strings use
the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the SerialInterfaceClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a Serial Interface object with obj_id 0</span><span class="w"></span>
<span class="n">serial_interface</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SerialInterfaceClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the Serial Interface object</span><span class="w"></span>
<span class="n">old_baud</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">serial_interface</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>’<span class="n">baud_rate</span>’<span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="mi">115200</span><span class="w"></span>
<span class="n">serial_interface</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">baud_rate</span>’<span class="p">,</span><span class="w"> </span><span class="mi">9600</span><span class="p">);</span><span class="w"></span>

<span class="c">% Note: the baud rate is now 9600. This com object uses 115200</span><span class="w"></span>

<span class="c">% Make a new com object at 9600 baud to continue communication</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">9600</span><span class="p">);</span><span class="w"></span>
<span class="n">serial_interface</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SerialInterfaceClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id34">
<h4>Python<a class="headerlink" href="#id34" title="Permalink to this headline">¶</a></h4>
<p>To use the Serial Interface Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Serial Interface Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Serial Interface Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;serial_interface&quot;</span><span class="p">,</span> <span class="s2">&quot;baud_rate&quot;</span><span class="p">,</span> <span class="mi">9600</span><span class="p">)</span>  <span class="c1"># change baud rate to 9600</span>
</pre></div>
</div>
</div>
<div class="section" id="id35">
<h4>Message Table<a class="headerlink" href="#id35" title="Permalink to this headline">¶</a></h4>
<p>Type ID 16 | Serial Interface</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 7%" />
<col style="width: 10%" />
<col style="width: 9%" />
<col style="width: 10%" />
<col style="width: 5%" />
<col style="width: 59%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>baud_rate</p></td>
<td><p>get, set</p></td>
<td><p>uint32</p></td>
<td><p>hz</p></td>
<td><p>Default is 115200. Reliable up to 2Mbps. Set also performs a save.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="servo-input-parser">
<h3>Servo Input Parser<a class="headerlink" href="#servo-input-parser" title="Permalink to this headline">¶</a></h3>
<p>The Servo Input Parser is an interface between the Multi Turn Position Controller and the PWM based
inputs like 1-2ms, OneShot, MultiShot, and DShot. This parser allows the user to control how ratiomatic
values from the PWM input are translated. Inputs can be mapped to PWM control, voltage control, velocity
control, and position control. Values are mapped between a minimum value and a maximum value, while
their units are interpreted based on the mapping.</p>
<div class="section" id="id36">
<h4>Arduino<a class="headerlink" href="#id36" title="Permalink to this headline">¶</a></h4>
<p>To use Servo Input Parser in Arduino, ensure iq module communication.hpp is included. This allows the
creation of a ServoInputParserClient object. See Table 6 for available messages. All message objects use the
Short Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the ServoInputParserClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">ServoInputParserClient</span> <span class="nf">svo</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">svo</span><span class="p">.</span><span class="n">mode_</span><span class="p">,(</span><span class="kr">uint8_t</span><span class="p">)</span><span class="mi">1</span><span class="p">);</span> <span class="c1">// Set to Voltage mode</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">svo</span><span class="p">.</span><span class="n">mode_</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id37">
<h4>C++<a class="headerlink" href="#id37" title="Permalink to this headline">¶</a></h4>
<p>To use Servo Input Parser in C++, include servo input parser client.hpp. This allows the creation of a
ServoInputParserClient object. See Table 6 for available messages. All message objects use the Short Name
with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the ServoInputParserClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;servo_input_parser_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Servo Input Parser object with obj_id 0</span>
    <span class="n">ServoInputParserClient</span> <span class="n">svo</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Servo Input Parser object</span>
    <span class="n">svo</span><span class="p">.</span><span class="n">mode_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="c1">// Position control mode</span>
    <span class="n">svo</span><span class="p">.</span><span class="n">mode_</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>
    <span class="n">svo</span><span class="p">.</span><span class="n">unit_min_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="o">-</span><span class="n">PI</span><span class="p">);</span>
    <span class="n">svo</span><span class="p">.</span><span class="n">unit_min_</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>
    <span class="n">svo</span><span class="p">.</span><span class="n">unit_max_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="n">PI</span><span class="p">);</span>
    <span class="n">svo</span><span class="p">.</span><span class="n">unit_max_</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id38">
<h4>Matlab<a class="headerlink" href="#id38" title="Permalink to this headline">¶</a></h4>
<p>To use Servo Input Parser in Matlab, all IQ communication code must be included in your path. This allows
the creation of a ServoInputParserClient object. See Table 6 for available messages. All message strings use
the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the ServoInputParserClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>
<span class="c">% Make a ServoInputParserClient object with obj_id 0</span><span class="w"></span>
<span class="n">svo</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ServoInputParserClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>
<span class="c">% Use the ServoInputParserClient object</span><span class="w"></span>
<span class="n">svo</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="nb">mode</span>’<span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Position</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="nb">mode</span><span class="w"></span>
<span class="n">svo</span><span class="p">.</span><span class="n">save</span><span class="p">(</span>’<span class="nb">mode</span>’<span class="p">);</span><span class="w"></span>
<span class="n">svo</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">unit_min</span>’<span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="nb">pi</span><span class="p">);</span><span class="w"></span>
<span class="n">svo</span><span class="p">.</span><span class="n">save</span><span class="p">(</span>’<span class="n">unit_min</span>’<span class="p">);</span><span class="w"></span>
<span class="n">svo</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">unit_max</span>’<span class="p">,</span><span class="w"> </span><span class="nb">pi</span><span class="p">);</span><span class="w"></span>
<span class="n">svo</span><span class="p">.</span><span class="n">save</span><span class="p">(</span>’<span class="n">unit_max</span>’<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id39">
<h4>Python<a class="headerlink" href="#id39" title="Permalink to this headline">¶</a></h4>
<p>To use the Servo Input Parser Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Servo Input Parser Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Servo Input Parser Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">firmware</span><span class="o">=</span><span class="s2">&quot;servo&quot;</span><span class="p">)</span>

<span class="c1"># Set Servo Limits</span>
<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;servo_input_parser&quot;</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>             <span class="c1"># Position Control Mode</span>
<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;servo_input_parser&quot;</span><span class="p">,</span> <span class="s2">&quot;unit_min&quot;</span><span class="p">,</span> <span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>  <span class="c1"># Min position: -pi</span>
<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;servo_input_parser&quot;</span><span class="p">,</span> <span class="s2">&quot;unit_max&quot;</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>   <span class="c1"># Max position:  pi</span>

<span class="c1"># Save Servo Limits</span>
<span class="n">vertiq</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;servo_input_parser&quot;</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">)</span>
<span class="n">vertiq</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;servo_input_parser&quot;</span><span class="p">,</span> <span class="s2">&quot;unit_min&quot;</span><span class="p">)</span>
<span class="n">vertiq</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;servo_input_parser&quot;</span><span class="p">,</span> <span class="s2">&quot;unit_max&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id40">
<h4>Message Table<a class="headerlink" href="#id40" title="Permalink to this headline">¶</a></h4>
<p>Type ID 78 | Servo Input Parser</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 8%" />
<col style="width: 11%" />
<col style="width: 15%" />
<col style="width: 10%" />
<col style="width: 8%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>mode</p></td>
<td><p>get, set, save</p></td>
<td><p>uint8</p></td>
<td><p>enum</p></td>
<td><p>0 = PWM, 1 = Voltage, 2 = Velocity, 3 = Position</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>unit_min</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>(mode)</p></td>
<td><p>Minimum value.  Unit determined by mode.</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>unit_max</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>(mode)</p></td>
<td><p>Maximum value.  Unit determined by mode.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="system-control">
<h3>System Control<a class="headerlink" href="#system-control" title="Permalink to this headline">¶</a></h3>
<p>System Control allows the user to perform low level tasks on the motor controller’s microcontroller and gather
basic information. The motor’s uptime can be read and set, allowing for flexible timing and synchronizing.
System Control also has a Module ID parameter, which allows motors to be bussed on a single serial line yet
addressed uniquely. System Control is unique since its ID is always 0 even when the Module ID has been
changed.</p>
<div class="section" id="id41">
<h4>Arduino<a class="headerlink" href="#id41" title="Permalink to this headline">¶</a></h4>
<p>To use System Control in Arduino, ensure iq module communication.hpp is included. This allows the creation
of a SystemControlClient object. See Table 12 for available messages. All message objects use the Short
Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the SystemControlClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">SystemControlClient</span> <span class="nf">sys</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
    <span class="c1">// Initialize Serial (for displaying information on the terminal)</span>
    <span class="nf">Serial</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">float</span> <span class="n">sys_time</span> <span class="o">=</span> <span class="mf">0.0f</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ser</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">time_</span><span class="p">,</span><span class="n">sys_time</span><span class="p">))</span>
        <span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">sys_time</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id42">
<h4>C++<a class="headerlink" href="#id42" title="Permalink to this headline">¶</a></h4>
<p>To use System Control in C++, include system control client.hpp. This allows the creation
of a SystemControlClient object. See Table 12 for available messages. All message objects use the Short Name with a
trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the SystemControlClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;system_control_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">float</span> <span class="n">time</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a System Control object with obj_id 0</span>
    <span class="c1">// System Control objects are always obj_id 0</span>
    <span class="n">SystemControlClient</span> <span class="n">system_control</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the System Control object</span>
    <span class="n">system_control</span><span class="p">.</span><span class="n">time_</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>
    <span class="c1">// time = system_control.time_.get_reply();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id43">
<h4>Matlab<a class="headerlink" href="#id43" title="Permalink to this headline">¶</a></h4>
<p>To use System Control in Matlab, all IQ communication code must be included in your path. This allows
the creation of a SystemControlClient object. See Table 12 for available messages. All message strings use
the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the SystemControlClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a System Control object with obj_id 0</span><span class="w"></span>
<span class="c">% System Control objects are always obj_id 0</span><span class="w"></span>
<span class="n">system_control</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SystemControlClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the System Control object</span><span class="w"></span>
<span class="nb">time</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">system_control</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>’<span class="nb">time</span>’<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id44">
<h4>Python<a class="headerlink" href="#id44" title="Permalink to this headline">¶</a></h4>
<p>To use the System Control Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the System Control Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the System Control Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">FW</span> <span class="o">=</span> <span class="n">vertiq</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system_control&quot;</span><span class="p">,</span> <span class="s2">&quot;firmware_version&quot;</span><span class="p">)</span>  <span class="c1"># Firmware Version Number</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Firmware: </span><span class="si">{</span><span class="n">FW</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id45">
<h4>Message Table<a class="headerlink" href="#id45" title="Permalink to this headline">¶</a></h4>
<p>Type ID 5 | System Control</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 6%" />
<col style="width: 16%" />
<col style="width: 12%" />
<col style="width: 9%" />
<col style="width: 5%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>reboot_program</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Reboots the motor controller with saved values</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>reboot_boot_loader</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Reboots into the boot loader</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>dev_id</p></td>
<td><p>get</p></td>
<td><p>uint16</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>rev_id</p></td>
<td><p>get</p></td>
<td><p>uint16</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>uid1</p></td>
<td><p>get</p></td>
<td><p>uint32</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>uid2</p></td>
<td><p>get</p></td>
<td><p>uint32</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>uid3</p></td>
<td><p>get</p></td>
<td><p>uint32</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>mem_size</p></td>
<td><p>get</p></td>
<td><p>uint16</p></td>
<td><p>Kb</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>build_year</p></td>
<td><p>get</p></td>
<td><p>uint16</p></td>
<td><p>year</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>build_month</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>mon</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p>build_day</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>day</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p>build_hour</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>hour</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>12</p></td>
<td><p>build_minute</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>min</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>13</p></td>
<td><p>build_second</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>s</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>14</p></td>
<td><p>module_id</p></td>
<td><p>get, set, save</p></td>
<td><p>uint8</p></td>
<td><p>id</p></td>
<td><p>The ID used for all obj_id on this module</p></td>
</tr>
<tr class="row-odd"><td><p>15</p></td>
<td><p>time</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>s</p></td>
<td><p>Internal clock time. If unchanged through software this is uptime</p></td>
</tr>
<tr class="row-even"><td><p>16</p></td>
<td><p>firmware_version</p></td>
<td><p>get</p></td>
<td><p>uint32</p></td>
<td><p>ver</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>17</p></td>
<td><p>hardware_version</p></td>
<td><p>get, set, save</p></td>
<td><p>uint32</p></td>
<td><p>ver</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>18</p></td>
<td><p>electronics_version</p></td>
<td><p>get, set, save</p></td>
<td><p>uint32</p></td>
<td><p>ver</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>19</p></td>
<td><p>firmware_valid</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>bool</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="temperature-estimator">
<h3>Temperature Estimator<a class="headerlink" href="#temperature-estimator" title="Permalink to this headline">¶</a></h3>
<p>The Temperature Estimator uses a conduction thermal model to estimate the temperature of components
not directly sensed. In the motor modules the Temperature Estimator estimates the motor coil temperature.
The temperature is used to derate the motor if the temperature rises into dangerous levels. The temperature
limits can be adjusted, though this is not recommended.</p>
<div class="section" id="id46">
<h4>Arduino<a class="headerlink" href="#id46" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Estimator in Arduino, ensure iq module communication.hpp is included. This
allows the creation of a TemperatureEstimatorClient object. See Table 11 for available messages. All
message objects use the Short Name with a trailing underscore. All messages use the standard Get/Set/Save
functions.</p>
<p>A minimal working example for the TemperatureEstimatorClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">TemperatureEstimatorClient</span> <span class="nf">tmp</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
    <span class="c1">// Initialize Serial (for displaying information on the terminal)</span>
    <span class="nf">Serial</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">float</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mf">0.0f</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ser</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">temp_</span><span class="p">,</span><span class="n">temperature</span><span class="p">))</span>
    <span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">temperature</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id47">
<h4>C++<a class="headerlink" href="#id47" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Estimator client in C++, include temperature estimator client.hpp. This allows the
creation of a TemperatureEstimatorClient object. See Table 11 for available messages. All message objects
use the Short Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the TemperatureEstimatorClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;temperature_estimator_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">float</span> <span class="n">temp</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Temperature Estimator object with obj_id 0</span>
    <span class="n">TemperatureEstimatorClient</span> <span class="n">temp_client</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Temperature Estimator Client</span>
    <span class="n">temp_client</span><span class="p">.</span><span class="n">temp_</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">com</span><span class="p">)</span>

    <span class="c1">// [Insert code for interfacing with hardware here]</span>

    <span class="c1">// temp = temp_client.temp_.get_reply();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id48">
<h4>Matlab<a class="headerlink" href="#id48" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Estimator client in Matlab, all IQ communication code must be included in your
path. This allows the creation of a TemperatureEstimatorClient object. See Table 11 for available messages.
All message strings use the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the TemperatureEstimatorClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>
<span class="c">% Make an TemperatureEstimatorClient object with obj_id 0</span><span class="w"></span>
<span class="n">tes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">TemperatureEstimatorClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>
<span class="c">% Use the TemperatureEstimatorClient object</span><span class="w"></span>
<span class="n">coil_temp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tes</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>’<span class="n">temp</span>’<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id49">
<h4>Python<a class="headerlink" href="#id49" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Estimator Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Temperature Estimator Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Temperature Estimator Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">temp</span> <span class="o">=</span> <span class="n">vertiq</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;temperature_estimator&quot;</span><span class="p">,</span> <span class="s2">&quot;temp&quot;</span><span class="p">)</span>  <span class="c1"># Estimated Motor Temperature</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated Motor Temperature: </span><span class="si">{</span><span class="n">temp</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id50">
<h4>Message Table<a class="headerlink" href="#id50" title="Permalink to this headline">¶</a></h4>
<p>Type ID 77 | Temperature Estimator</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 5%" />
<col style="width: 12%" />
<col style="width: 9%" />
<col style="width: 6%" />
<col style="width: 3%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>temp</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>degC</p></td>
<td><p>Temperature of the motor coils</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>otw</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>degC</p></td>
<td><p>Over temperature warning. Derating of the motor begins at this temperature.</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>otlo</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>degC</p></td>
<td><p>Over temperature lock out. Derating of the motor end at this temperature, where the motor is fully disabled.</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>thermal_resistance</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>K/W</p></td>
<td><p>Model thermal resistance</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>thermal_capacitance</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>J/K</p></td>
<td><p>Model thermal capacitance</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>derate</p></td>
<td><p>get</p></td>
<td><p>Fix16</p></td>
<td><p>PU</p></td>
<td><p>Amount of derating applied to motor [0 65536] where 65536 is normal operation</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="temperature-monitor-uc">
<h3>Temperature Monitor UC<a class="headerlink" href="#temperature-monitor-uc" title="Permalink to this headline">¶</a></h3>
<p>The Temperature Monitor Microcontroller reads, filters, and reports the microcontroller’s internal temperature.
The temperature is used to derate the motor if the temperature rises into dangerous levels. The filter’s
cutoff frequency and the temperature limits can be adjusted, though this is not recommended.</p>
<div class="section" id="id51">
<h4>Arduino<a class="headerlink" href="#id51" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Monitor Microcontroller in Arduino, ensure iq module communication.hpp is included.
This allows the creation of a TemperatureMonitorUcClient object. See Table 10 for available
messages. All message objects use the Short Name with a trailing underscore. All messages use the standard
Get/Set/Save functions.</p>
<p>A minimal working example for the TemperatureMonitorUcClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">TemperatureMonitorUcClient</span> <span class="nf">tmp</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
    <span class="c1">// Initialize Serial (for displaying information on the terminal)</span>
    <span class="nf">Serial</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">float</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mf">0.0f</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ser</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">uc_temp_</span><span class="p">,</span><span class="n">temperature</span><span class="p">))</span>
        <span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">temperature</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id52">
<h4>C++<a class="headerlink" href="#id52" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Monitor Microcontroller client in C++, include temperature monitor uc client.hpp.
This allows the creation of a TemperatureMonitorUcClient object. See Table 10 for available messages. All
message objects use the Short Name with a trailing underscore. All messages use the standard Get/Set/Save
functions.</p>
<p>A minimal working example for the TemperatureMonitorUcClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;temperature_monitor_uc_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">float</span> <span class="n">uc_temp</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Temperature Monitor Microcontroller object with obj_id 0</span>
    <span class="n">TemperatureMonitorUcClient</span> <span class="n">tuc</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Temperature Monitor Microcontroller object</span>
    <span class="n">tuc</span><span class="p">.</span><span class="n">uc_temp_</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>
    <span class="c1">// Read response</span>
    <span class="n">uc_temp</span> <span class="o">=</span> <span class="n">tuc</span><span class="p">.</span><span class="n">uc_temp_</span><span class="p">.</span><span class="n">get_reply</span><span class="p">();</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id53">
<h4>Matlab<a class="headerlink" href="#id53" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Monitor Microcontroller client in Matlab, all IQ communication code must be
included in your path. This allows the creation of a TemperatureMonitorUcClient object. See Table 10 for
available messages. All message strings use the Short Names. All messages use the standard Get/Set/Save
functions.</p>
<p>A minimal working example for the TemperatureMonitorUcClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make an TemperatureMonitorUcClient object with obj_id 0</span><span class="w"></span>
<span class="n">tuc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">TemperatureMonitorUcClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the TemperatureMonitorUcClient object</span><span class="w"></span>
<span class="n">uc_temp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tuc</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>’<span class="n">uc_temp</span>’<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id54">
<h4>Python<a class="headerlink" href="#id54" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Monitor Microcontroller Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Temperature Monitor Microcontroller Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Temperature Monitor Microcontroller Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">temp</span> <span class="o">=</span> <span class="n">vertiq</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;temperature_monitor_uc&quot;</span><span class="p">,</span> <span class="s2">&quot;uc_temp&quot;</span><span class="p">)</span>  <span class="c1"># Internal UC Temperature</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Internal UC temperature: </span><span class="si">{</span><span class="n">temp</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id55">
<h4>Message Table<a class="headerlink" href="#id55" title="Permalink to this headline">¶</a></h4>
<p>Type ID 73 | Temperature Monitor Microcontroller</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 5%" />
<col style="width: 7%" />
<col style="width: 10%" />
<col style="width: 7%" />
<col style="width: 4%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>uc_temp</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>degC</p></td>
<td><p>Temperature of the microcontroller</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>filter_fs</p></td>
<td><p>get</p></td>
<td><p>uint32</p></td>
<td><p>Hz</p></td>
<td><p>Low pass filter sample frequency</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>filter_fc</p></td>
<td><p>get, set, save</p></td>
<td><p>uint32</p></td>
<td><p>Hz</p></td>
<td><p>Low pass filter cutoff frequency</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>otw</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>degC</p></td>
<td><p>Over temperature warning. Derating of the motor begins at this temperature.</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>otlo</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>degC</p></td>
<td><p>Over temperature lock out. Derating of the motor end at this temperature, where the motor is fully disabled.</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>derate</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>PU</p></td>
<td><p>Amount of derating applied to motor [0 1]</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="step-direction-firmware">
<h2>Step Direction Firmware<a class="headerlink" href="#step-direction-firmware" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id56">
<h3>Multi Turn Angle Control<a class="headerlink" href="#id56" title="Permalink to this headline">¶</a></h3>
<p>The Multi-turn Angle Controller is a non-wrapping, PID, position controller. It is capable of storing angular
to linear transmission information, mimicking a linear position controller. It also features a minimum jerk
trajectory generator. The controller has a 32 trajectory buffer so that transitions between trajectories are
seamless.</p>
<div class="section" id="id57">
<h4>Arduino<a class="headerlink" href="#id57" title="Permalink to this headline">¶</a></h4>
<p>To use Multi-turn Angle Controller in Arduino, ensure iq module communication.hpp is included. This
allows the creation of a MultiTurnAngleControlClient object. See Table 2 for available messages. All
message objects use the Short Name with a trailing underscore. All messages use the standard Get/Set/Save
functions.</p>
<p>A minimal working example for the MultiTurnAngleControlClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">MultiTurnAngleControlClient</span> <span class="nf">mult</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">mult</span><span class="p">.</span><span class="n">trajectory_angular_displacement_</span><span class="p">,</span><span class="mf">3.14f</span><span class="p">);</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">mult</span><span class="p">.</span><span class="n">trajectory_duration_</span><span class="p">,</span><span class="mf">0.5f</span><span class="p">);</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">mult</span><span class="p">.</span><span class="n">trajectory_angular_displacement_</span><span class="p">,</span><span class="mf">0.0f</span><span class="p">);</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">mult</span><span class="p">.</span><span class="n">trajectory_duration_</span><span class="p">,</span><span class="mf">0.5f</span><span class="p">);</span>
    <span class="nf">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id58">
<h4>C++<a class="headerlink" href="#id58" title="Permalink to this headline">¶</a></h4>
<p>To use Multi-turn Angle Controller in C++, include multi turn angle control client.hpp. This allows the
creation of a MultiTurnAngleControlClient object. See Table 2 for available messages. All message objects
use the Short Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the MultiTurnAngleControlClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;multi_turn_angle_control_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">float</span> <span class="n">angle</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Multi-turn Angle Controller object with obj_id 0</span>
    <span class="n">MultiTurnAngleControlClient</span> <span class="n">angle_ctrl</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Multi-turn Angle Controller object</span>
    <span class="n">angle_ctrl</span><span class="p">.</span><span class="n">obs_angular_displacement_</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>
    <span class="n">angle_ctrl</span><span class="p">.</span><span class="n">ctrl_angle_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span><span class="mf">0.0f</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>
    <span class="c1">// Read response</span>
    <span class="n">angle</span> <span class="o">=</span> <span class="n">angle_ctrl</span><span class="p">.</span><span class="n">ctrl_angle_</span><span class="p">.</span><span class="n">get_reply</span><span class="p">();</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id59">
<h4>Matlab<a class="headerlink" href="#id59" title="Permalink to this headline">¶</a></h4>
<p>To use Multi-turn Angle Controller in Matlab, all IQ communication code must be included in your path.
This allows the creation of a MultiTurnAngleControlClient object. See Table 2 for available messages. All
message strings use the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the MultiTurnAngleControlClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a MultiTurnAngleControlClient object with obj_id 0</span><span class="w"></span>
<span class="n">angle_ctrl</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MultiTurnAngleControlClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the MultiTurnAngleControlClient object</span><span class="w"></span>
<span class="n">velocity_filtered</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">angle_ctrl</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>’<span class="n">obs_angular_displacement</span>’<span class="p">);</span><span class="w"></span>
<span class="n">angle_ctrl</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">ctrl_angle</span>’<span class="p">,</span><span class="mi">0</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id60">
<h4>Python<a class="headerlink" href="#id60" title="Permalink to this headline">¶</a></h4>
<p>To use the Multi-Turn Angle Control Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Multi-Turn Angle Control Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Multi-Turn Angle Control Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">firmware</span><span class="o">=</span><span class="s2">&quot;servo&quot;</span><span class="p">)</span>   <span class="c1"># Servo Firmware uses this client</span>

<span class="c1"># Set the trajectory for the motor to complete 1 full rotation</span>
<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;multi_turn_angle_control&quot;</span><span class="p">,</span> <span class="s2">&quot;trajectory_angular_displacement&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

<span class="c1"># Sets trajectory duration for 2 seconds</span>
<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;multi_turn_angle_control&quot;</span><span class="p">,</span> <span class="s2">&quot;duration&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id61">
<h4>Message Table<a class="headerlink" href="#id61" title="Permalink to this headline">¶</a></h4>
<p>Type ID 59 | Multi-turn Angle Controller</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 4%" />
<col style="width: 18%" />
<col style="width: 9%" />
<col style="width: 6%" />
<col style="width: 10%" />
<col style="width: 53%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>ctrl_mode</p></td>
<td><p>get</p></td>
<td><p>int8</p></td>
<td><p>enum</p></td>
<td><p>no_change = -1, brake=0, coast=1, pwm=2, volts=3, velocity=4, angle=5, trajectory=6</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>ctrl_brake</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Shorts motor phases, slows motor down dissipating energy in motor</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>ctrl_coast</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Disables all drive circuitry, motor passively coasts</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>ctrl_angle</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td><p>Angular location command</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>ctrl_velocity</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>rad/s</p></td>
<td><p>Angular velocity command</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>angle_Kp</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>V/rad</p></td>
<td><p>Proportional gain</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>angle_Ki</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>V/(rad*s)</p></td>
<td><p>Integral gain</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>angle_Kd</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>V/(rad/s)</p></td>
<td><p>Derivative gain</p></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>timeout</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>s</p></td>
<td><p>The controller must receive a message within this time otherwise it is set to coast mode</p></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>ctrl_pwm</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>pwm</p></td>
<td><p>Spins motor with this throttle [-1, 1]</p></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p>ctrl_volts</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>Spins motor with this voltage</p></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p>obs_angular_displacement</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td><p>Observed angular location</p></td>
</tr>
<tr class="row-even"><td><p>12</p></td>
<td><p>obs_angular_velocity</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>rad/s</p></td>
<td><p>Observed angular velocity</p></td>
</tr>
<tr class="row-odd"><td><p>13</p></td>
<td><p>meter_per_rad</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>m/rad</p></td>
<td><p>Transmission between angular and linear motion</p></td>
</tr>
<tr class="row-even"><td><p>14</p></td>
<td><p>ctrl_linear_displacement</p></td>
<td><p>get, set,</p></td>
<td><p>float</p></td>
<td><p>m</p></td>
<td><p>Linear equivalent to ctrl_angle</p></td>
</tr>
<tr class="row-odd"><td><p>15</p></td>
<td><p>ctrl_linear_velocity</p></td>
<td><p>get, set,</p></td>
<td><p>float</p></td>
<td><p>m/s</p></td>
<td><p>Linear equivalent to ctrl_velocity</p></td>
</tr>
<tr class="row-even"><td><p>16</p></td>
<td><p>obs_linear_displacement</p></td>
<td><p>get, set,</p></td>
<td><p>float</p></td>
<td><p>m</p></td>
<td><p>Observed linear location</p></td>
</tr>
<tr class="row-odd"><td><p>17</p></td>
<td><p>obs_linear_velocity</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>m/s</p></td>
<td><p>Observed linear velocity</p></td>
</tr>
<tr class="row-even"><td><p>18</p></td>
<td><p>angular_speed_max</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>rad/s</p></td>
<td><p>The controller will never attempt to exceed this speed</p></td>
</tr>
<tr class="row-odd"><td><p>19</p></td>
<td><p>trajectory_angular_displacement</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td><p>Final absolute displacement of trajectory.</p></td>
</tr>
<tr class="row-even"><td><p>20</p></td>
<td><p>trajectory_angular_velocity</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>rad/s</p></td>
<td><p>Final velocity of the trajectory. Defaults to 0.</p></td>
</tr>
<tr class="row-odd"><td><p>21</p></td>
<td><p>trajectory_angular_acceleration</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><div class="math notranslate nohighlight">
\[rad/s^2\]</div>
</td>
<td><p>Final acceleration of the trajectory. Defaults to 0.</p></td>
</tr>
<tr class="row-even"><td><p>22</p></td>
<td><p>trajectory_duration</p></td>
<td><p>set</p></td>
<td><p>float</p></td>
<td><p>s</p></td>
<td><p>Duration of trajectory. Trajectory is executed or queued once this is sent.</p></td>
</tr>
<tr class="row-odd"><td><p>23</p></td>
<td><p>trajectory_linear_displacement</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>m</p></td>
<td><p>Final absolute displacement of trajectory.</p></td>
</tr>
<tr class="row-even"><td><p>24</p></td>
<td><p>trajectory_linear_velocity</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>m/s</p></td>
<td><p>Final velocity of the trajectory. Defaults to 0.</p></td>
</tr>
<tr class="row-odd"><td><p>25</p></td>
<td><p>trajectory_linear_acceleration</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><div class="math notranslate nohighlight">
\[m/s^2\]</div>
</td>
<td><p>Final acceleration of the trajectory. Defaults to 0.</p></td>
</tr>
<tr class="row-even"><td><p>26</p></td>
<td><p>trajectory_average_speed</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><div class="math notranslate nohighlight">
\[m/s^2\]</div>
</td>
<td><p>Average speed of a trajectory.  Trajectory is executed or queued once this is sent. Must be $&gt;0$.</p></td>
</tr>
<tr class="row-odd"><td><p>27</p></td>
<td><p>trajectory_queue_mode</p></td>
<td><p>get, set, save</p></td>
<td><p>int8</p></td>
<td><div class="math notranslate nohighlight">
\[m/s^2\]</div>
</td>
<td><p>append=0, overwrite=1</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="id62">
<h3>Brushless Drive<a class="headerlink" href="#id62" title="Permalink to this headline">¶</a></h3>
<p>Brushless Drive is the low level driver of the motor’s phase voltage.</p>
<div class="section" id="id63">
<h4>Arduino<a class="headerlink" href="#id63" title="Permalink to this headline">¶</a></h4>
<p>To use Brushless Drive in Arduino, ensure iq module communication.hpp is included. This allows the creation of a BrushlessDriveClient object.
See Table 3 for available messages. All message objects use the Short
Name with a trailing underscore. All messages use the standard <code class="docutils literal notranslate"><span class="pre">Get/Set/Save</span></code> functions.</p>
<p>A minimal working example for the BrushlessDriveClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communicaiton.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">BrushlessDriveClient</span> <span class="nf">mot</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">mot</span><span class="p">.</span><span class="n">drive_spin_volts_</span><span class="p">,</span><span class="mf">0.1f</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id64">
<h4>C++<a class="headerlink" href="#id64" title="Permalink to this headline">¶</a></h4>
<p>To use Brushless Drive in C++, include brushless drive client.hpp. This allows the creation of a <code class="docutils literal notranslate"><span class="pre">BrushlessDriveClient</span></code> object.
See Table 3 for available messages. All message objects use the Short Name with a trailing underscore. All messages use the standard <code class="docutils literal notranslate"><span class="pre">Get/Set/Save</span></code> functions.</p>
<p>A minimal working example for the BrushlessDriveClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;propeller_motor_control_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">float</span> <span class="n">voltage</span> <span class="o">=</span> <span class="mf">3.0f</span><span class="p">;</span> <span class="c1">// volts</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>

<span class="c1">// Make a communication interface object</span>
<span class="c1">// This is what creates and parses packets</span>
<span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

<span class="c1">// Make a Temperature Estimator Client object with obj_id 0</span>
<span class="n">BrushlessDriveClient</span> <span class="n">brushless</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="c1">// Drives the motor at 3 Volts</span>
<span class="n">brushless</span><span class="p">.</span><span class="n">drive_spin_volts_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="n">voltage</span><span class="p">);</span>

<span class="c1">// Insert code for interfacing with hardware here</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id65">
<h4>Matlab<a class="headerlink" href="#id65" title="Permalink to this headline">¶</a></h4>
<p>To use Brushless Drive Controller in Matlab, all IQ communication code must be included in your path.
This allows the creation of a BrushlessDriveClient object. See Table 2 for available messages. All
message strings use the Short Names. All messages use the standard <code class="docutils literal notranslate"><span class="pre">Get/Set/Save</span></code> functions.</p>
<p>A minimal working example for the BrushlessDriveClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a BrushlessDriveClient object with obj_id 0</span><span class="w"></span>
<span class="n">drive</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">BrushlessDriveClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the BrushlessDriveClient object</span><span class="w"></span>
<span class="n">drive</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">drive_spin_volts</span>’<span class="p">,</span><span class="mf">3.0</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id66">
<h4>Python<a class="headerlink" href="#id66" title="Permalink to this headline">¶</a></h4>
<p>To use the Brushless Drive Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Brushless Drive Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the BrushlessDriveClient is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;brushless_drive&quot;</span><span class="p">,</span> <span class="s2">&quot;drive_spin_volts&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># Spins motor at 5 volts</span>
</pre></div>
</div>
</div>
<div class="section" id="id67">
<h4>Message Table<a class="headerlink" href="#id67" title="Permalink to this headline">¶</a></h4>
<p>Type ID 50 | Brushless Drive</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 4%" />
<col style="width: 10%" />
<col style="width: 8%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 65%" />
<col style="width: 3%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>drive_mode</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td></td>
<td><p>0 = phase_pwm, 1 = phase_volts, 2 = spin_pwm, 3 = spin_volts, 4 = brake, 5 = coast</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>drive_phase_pwm</p></td>
<td><p>set</p></td>
<td><p>float</p></td>
<td><p>pwm</p></td>
<td><p>Open loop (gimbal) mode with this trottle [-1, 1].  Use with phase_angle.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>drive_phase_volts</p></td>
<td><p>set</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>Open loop (gimbal) mode with this voltage.  Use with phase_angle.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>drive_spin_pwm</p></td>
<td><p>set</p></td>
<td><p>float</p></td>
<td><p>pwm</p></td>
<td><p>Spins motor with this throttle [-1, 1]</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>drive_spin_volts</p></td>
<td><p>set</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>Spins motor with this voltage</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>drive_brake</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Shorts motor phases, slows motor down dissipating energy in motor</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>drive_coast</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Disables all drive circuitry, motor passively coasts</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>drive_angle_offset</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td><p>Analogous to motor timing. This is internally computed by the motor.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>drive_pwm</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>pwm</p></td>
<td><p>The applied pwm after all computation and limiting [-1, 1]</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>drive_volts</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>The applied pwm after all computation and limiting</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p>mech_lead_angle</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p>obs_supply_volts</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>Observed supply voltage</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>12</p></td>
<td><p>obs_angle</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td><p>Observed motor angle</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>13</p></td>
<td><p>obs_velocity</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>rad/s</p></td>
<td><p>Observed motor velocity</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>14</p></td>
<td><p>motor_pole_pairs</p></td>
<td><p>get, set, save</p></td>
<td><p>uint16</p></td>
<td></td>
<td><p>Number of motor pole pairs (magnets/2)</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>15</p></td>
<td><p>motor_emf_shape</p></td>
<td><p>get, set, save</p></td>
<td><p>uint8</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>16</p></td>
<td><p>permute_wires</p></td>
<td><p>get, set, save</p></td>
<td><p>uint8</p></td>
<td><p>bool</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>17</p></td>
<td><p>calibration_angle</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>18</p></td>
<td><p>lead_time</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>s</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>19</p></td>
<td><p>commutation_hz</p></td>
<td><p>get, set, save</p></td>
<td><p>uint32</p></td>
<td><p>Hz</p></td>
<td><p>Frequency of commutation.  Higher frequencies run faster and more efficient, but may not give the controller enough computation time.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>20</p></td>
<td><p>phase_angle</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td><p>Angle used for open loop (gimbal) mode. Use with drive_phase_pwm or drive_phase_volts</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>32</p></td>
<td><p>motor_Kv</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>RPM/V</p></td>
<td><p>Motor’s voltage constant</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>33</p></td>
<td><p>motor_R_ohm</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>ohm</p></td>
<td><p>Motor’s resistance</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>34</p></td>
<td><p>motor_I_max</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>A</p></td>
<td><p>Max allowable motor current</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>35</p></td>
<td><p>volts_limit</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>Max regen voltage</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>36</p></td>
<td><p>est_motor_amps</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>A</p></td>
<td><p>Estimated motor amps</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>37</p></td>
<td><p>est_motor_torque</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>Nm</p></td>
<td><p>Estimated motor torque</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>38</p></td>
<td><p>motor_redline_start</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>rad/s</p></td>
<td><p>Speed at which motor begins to derate</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>39</p></td>
<td><p>motor_redline_end</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>rad/s</p></td>
<td><p>Speed at which the motor is fully derated</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>40</p></td>
<td><p>motor_l</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>H</p></td>
<td><p>Cross inductance</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>41</p></td>
<td><p>derate</p></td>
<td><p>get</p></td>
<td><p>int32</p></td>
<td><p>PU fix16</p></td>
<td><p>Amount of derating.  No derate = 65536, full derate = 0</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>42</p></td>
<td><p>i_soft_start</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>A</p></td>
<td><p>Current at which motor begins to derate</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>43</p></td>
<td><p>i_soft_end</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>A</p></td>
<td><p>Current at which the motor is fully derated</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="id68">
<h3>Anticogging<a class="headerlink" href="#id68" title="Permalink to this headline">¶</a></h3>
<p>Anticogging is the process of electronically canceling out cogging torque of a motor. Each motor is loaded
with its unique cog information. This class allows enabling and disabling the anticogging process. Though
this class can also manipulate the cog information it is not recommended to manipulate or erase this data
as it is unrecoverable.</p>
<div class="section" id="id69">
<h4>Arduino<a class="headerlink" href="#id69" title="Permalink to this headline">¶</a></h4>
<p>To use the Anticogging in Arduino, ensure iq module communication.hpp is included. This allows the
creation of a AnticoggingClient object. See Table below for available messages. All message objects use the
Short Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the AnticoggingClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>
<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>

<span class="n">BrushlessDriveClient</span> <span class="nf">mot</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="n">AnticoggingClient</span> <span class="nf">cog</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">mot</span><span class="p">.</span><span class="n">drive_spin_volts_</span><span class="p">,</span><span class="mf">0.0f</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Spin the motor with your hand and feel Anticogging turning on and off</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">cog</span><span class="p">.</span><span class="n">is_enabled_</span><span class="p">,(</span><span class="kr">uint8_t</span><span class="p">)</span><span class="mi">1</span><span class="p">);</span>
    <span class="nf">delay</span><span class="p">(</span><span class="mi">2000</span><span class="p">);</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">cog</span><span class="p">.</span><span class="n">is_enabled_</span><span class="p">,(</span><span class="kr">uint8_t</span><span class="p">)</span><span class="mi">0</span><span class="p">);</span>
    <span class="nf">delay</span><span class="p">(</span><span class="mi">2000</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id70">
<h4>C++<a class="headerlink" href="#id70" title="Permalink to this headline">¶</a></h4>
<p>To use the Anticogging client in C++, include anticogging client.hpp. This allows the creation of an
AnticoggingClient object. See Table below for available messages. All message objects use the Short Name with a
trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the AnticoggingClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;anticogging_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a ESC Propeller Input Parser object with obj_id 0</span>
    <span class="n">AnticoggingClient</span> <span class="n">cog</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the ESC Propeller Input Parser object</span>
    <span class="n">cog</span><span class="p">.</span><span class="n">is_enabled_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id71">
<h4>Matlab<a class="headerlink" href="#id71" title="Permalink to this headline">¶</a></h4>
<p>To use the Anticogging client in Matlab, all IQ communication code must be included in your path. This
allows the creation of a AnticoggingClient object. See Table below for available messages. All message strings
use the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the AnticoggingClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make an AnticoggingClient object with obj_id 0</span><span class="w"></span>
<span class="n">cog</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">AnticoggingClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the AnticoggingClient object</span><span class="w"></span>
<span class="n">cog</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">is_enabled</span>’<span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id72">
<h4>Python<a class="headerlink" href="#id72" title="Permalink to this headline">¶</a></h4>
<p>To use the Anticogging Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Anticogging Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Anticogging Client is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">firmware</span><span class="o">=</span><span class="s2">&quot;servo&quot;</span><span class="p">)</span>

<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;anticogging&quot;</span><span class="p">,</span> <span class="s2">&quot;is_enabled&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Turns on Anticogging</span>
</pre></div>
</div>
</div>
<div class="section" id="id73">
<h4>Message Table<a class="headerlink" href="#id73" title="Permalink to this headline">¶</a></h4>
<p>Type ID 71 | Anticogging</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 5%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 6%" />
<col style="width: 9%" />
<col style="width: 62%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>table_size</p></td>
<td><p>get</p></td>
<td><p>uint16</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>Size of the anticogging table</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>is_data_valid</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>bool</p></td>
<td><p>Indicates if the cog information is valid.  is_enabled must be called first to check the cog information.</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>is_enabled</p></td>
<td><p>get, set, save</p></td>
<td><p>uint8</p></td>
<td><p>bool</p></td>
<td><p>Indicates if anticogging is running.  This will stay 0/false if the is_data_valid field is 0/false.</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>erase</p></td>
<td><p>set</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>Erases the cog information.  This is not recommended.</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>left_shift</p></td>
<td><p>get, set, save</p></td>
<td><p>uint8</p></td>
<td><div class="math notranslate nohighlight">
\[*2^x\]</div>
</td>
<td><p>Anticog multiplier.  Modification is not recommended.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="id74">
<h3>Buzzer Control<a class="headerlink" href="#id74" title="Permalink to this headline">¶</a></h3>
<p>The Buzzer Control handles all beeps and songs played by the motor. The controls mimic standard MIDI
commands allowing simple translation from MIDI to Buzzer Control commands. The volume max parameter
controls the absolute volume across all notes, measured in volts. To play a note on the buzzer, set the
frequency by sending a ’hz’ command, set a relative volume by sending a ’volume’ command, set a note
length by sending a ’duration’ command, and finally put the controller in note mode by sending ’ctrl note’.</p>
<div class="section" id="id75">
<h4>Arduino<a class="headerlink" href="#id75" title="Permalink to this headline">¶</a></h4>
<p>To use the Buzzer Control in Arduino, ensure iq module communication.hpp is included. This allows the
creation of a BuzzerControlClient object. See Table 5 for available messages. All message objects use the
Short Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the BuzzerControlClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">BuzzerControlClient</span> <span class="nf">buz</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">buz</span><span class="p">.</span><span class="n">hz_</span><span class="p">,(</span><span class="kr">uint16_t</span><span class="p">)</span><span class="mi">1000</span><span class="p">);</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">buz</span><span class="p">.</span><span class="n">volume_</span><span class="p">,(</span><span class="kr">uint8_t</span><span class="p">)</span><span class="mi">127</span><span class="p">);</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">buz</span><span class="p">.</span><span class="n">duration_</span><span class="p">,(</span><span class="kr">uint16_t</span><span class="p">)</span><span class="mi">500</span><span class="p">);</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">buz</span><span class="p">.</span><span class="n">ctrl_note_</span><span class="p">);</span>
    <span class="nf">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id76">
<h4>C++<a class="headerlink" href="#id76" title="Permalink to this headline">¶</a></h4>
<p>To use the Buzzer Control in C++, include buzzer control client.hpp. This allows the creation of a
BuzzerControlClient object. See Table 5 for available messages. All message objects use the Short Name with a
trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the BuzzerControlClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;buzzer_control_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Buzzer Control object with obj_id 0</span>
    <span class="n">BuzzerControlClient</span> <span class="n">buz</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Buzzer Control object</span>
    <span class="n">buz</span><span class="p">.</span><span class="n">hz_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">440</span><span class="p">);</span> <span class="c1">// A4</span>
    <span class="n">buz</span><span class="p">.</span><span class="n">volume_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">127</span><span class="p">);</span> <span class="c1">// Max volume</span>
    <span class="n">buz</span><span class="p">.</span><span class="n">duration_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span> <span class="c1">// 500ms</span>
    <span class="n">buz</span><span class="p">.</span><span class="n">ctrl_note_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">);</span> <span class="c1">// Note mode</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id77">
<h4>Matlab<a class="headerlink" href="#id77" title="Permalink to this headline">¶</a></h4>
<p>To use the Buzzer Contol in Matlab, all IQ communication code must be included in your path. This allows
the creation of a BuzzerControlClient object. See Table 5 for available messages. All message strings use
the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the BuzzerControlClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a BuzzerControlClient object with obj_id 0</span><span class="w"></span>
<span class="n">buz</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">BuzzerControlClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the BuzzerControlClient object</span><span class="w"></span>
<span class="n">buz</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">hz</span>’<span class="p">,</span><span class="mi">440</span><span class="p">);</span><span class="w"> </span><span class="c">% A4</span><span class="w"></span>
<span class="n">buz</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="nb">volume</span>’<span class="p">,</span><span class="mi">127</span><span class="p">);</span><span class="w"> </span><span class="c">% Max volume</span><span class="w"></span>
<span class="n">buz</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="nb">duration</span>’<span class="p">,</span><span class="mi">500</span><span class="p">);</span><span class="w"> </span><span class="c">% 500ms</span><span class="w"></span>
<span class="n">buz</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">ctrl_note</span>’<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id78">
<h4>Python<a class="headerlink" href="#id78" title="Permalink to this headline">¶</a></h4>
<p>To use the Buzzer Control Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Buzzer Control Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Buzzer Control Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;buzzer_control&quot;</span><span class="p">,</span> <span class="s2">&quot;hz&quot;</span><span class="p">,</span> <span class="mi">440</span><span class="p">)</span>         <span class="c1"># A4</span>
<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;buzzer_control&quot;</span><span class="p">,</span> <span class="s2">&quot;volume&quot;</span><span class="p">,</span> <span class="mi">127</span><span class="p">)</span>     <span class="c1"># Max Volume</span>
<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;buzzer_control&quot;</span><span class="p">,</span> <span class="s2">&quot;duration&quot;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c1"># 1000ms</span>
<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;buzzer_control&quot;</span><span class="p">,</span> <span class="s2">&quot;ctrl_note&quot;</span><span class="p">)</span>       <span class="c1"># Start the Note</span>
</pre></div>
</div>
</div>
<div class="section" id="id79">
<h4>Message Table<a class="headerlink" href="#id79" title="Permalink to this headline">¶</a></h4>
<p>Type ID 61 | Buzzer Control</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 7%" />
<col style="width: 10%" />
<col style="width: 13%" />
<col style="width: 9%" />
<col style="width: 6%" />
<col style="width: 55%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>ctrl_mode</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>enum</p></td>
<td><p>no_change = -1, brake=0, coast=1, note=2, song=3</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>ctrl_brake</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Shorts motor phases, slows motor down dissipating energy in motor</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>ctrl_coast</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Disables all drive circuitry, motor passively coasts</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>ctrl_note</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Must have sent a ‘hz’ and ‘volume’ first</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>volume_max</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>Uses this voltage command for maximum volume</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>hz</p></td>
<td><p>get, set</p></td>
<td><p>uint16</p></td>
<td><p>hz</p></td>
<td><p>Frequency of the note</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>volume</p></td>
<td><p>get, set</p></td>
<td><p>uint8</p></td>
<td><p>0-127</p></td>
<td><p>Individual note volume as fraction of 127</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>duration</p></td>
<td><p>get, set</p></td>
<td><p>uint16</p></td>
<td><p>ms</p></td>
<td><p>Note length.  Assumed max (65535 ms) if not sent.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="id80">
<h3>Persistent Memory<a class="headerlink" href="#id80" title="Permalink to this headline">¶</a></h3>
<p>The Persistent Memory class controls the non-volatile memory. You can use this class to revert the motor
to factory defaults.</p>
<div class="section" id="id81">
<h4>Arduino<a class="headerlink" href="#id81" title="Permalink to this headline">¶</a></h4>
<p>To use Persistent Memory in Arduino, ensure iq module communication.hpp is included. This allows the
creation of a PersistentMemoryClient object. See Table 13 for available messages. All message objects use
the Short Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the PersistentMemoryClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">PersistentMemoryClient</span> <span class="nf">mem</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">mem</span><span class="p">.</span><span class="n">revert_to_default_</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id82">
<h4>C++<a class="headerlink" href="#id82" title="Permalink to this headline">¶</a></h4>
<p>To use Persistent Memory in C++, include persistent memory client.hpp. This allows the creation of a
PersistentMemoryClient object. See Table 13 for available messages. All message objects use the Short
Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the PersistentMemoryClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;persistent_memory_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Persistent Memory object with obj_id 0</span>
    <span class="n">PersistentMemoryClient</span> <span class="n">mem</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Persistent Memory object</span>
    <span class="n">mem</span><span class="p">.</span><span class="n">revert_to_default_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id83">
<h4>Matlab<a class="headerlink" href="#id83" title="Permalink to this headline">¶</a></h4>
<p>To use Persistent Memory in Matlab, all IQ communication code must be included in your path. This allows
the creation of a PersistentMemoryClient object. See Table 13 for available messages. All message strings
use the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the PersistentMemoryClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a PersistentMemoryClient object with obj_id 0</span><span class="w"></span>
<span class="n">mem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">PersistentMemoryClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the PersistentMemoryClient object</span><span class="w"></span>
<span class="n">mem</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">revert_to_default</span>’<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id84">
<h4>Python<a class="headerlink" href="#id84" title="Permalink to this headline">¶</a></h4>
<p>To use the Persistent Memory Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Persistent Memory Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Persistent Memory Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;persistent_memory&quot;</span><span class="p">,</span> <span class="s2">&quot;revert_to_default&quot;</span><span class="p">)</span>  <span class="c1"># erases saved values except for factory defaults</span>
</pre></div>
</div>
</div>
<div class="section" id="id85">
<h4>Message Table<a class="headerlink" href="#id85" title="Permalink to this headline">¶</a></h4>
<p>Type ID 11 | Persistent Memory</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 5%" />
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 8%" />
<col style="width: 4%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>erase</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Erases all saved values including calibration data and product key.  Highly not recommended.</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>revert_to_default</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Erases all saved values except for those set in factory.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="id86">
<h3>Power Monitor<a class="headerlink" href="#id86" title="Permalink to this headline">¶</a></h3>
<p>The Power Monitor measures the power coming into the module. It reports input voltage and current as
well as calculates power and energy consumed. A built in low pass filter with adjustable cutoff frequency
smooths these values.</p>
<div class="section" id="id87">
<h4>Arduino<a class="headerlink" href="#id87" title="Permalink to this headline">¶</a></h4>
<p>To use Power Monitor in Arduino, ensure iq module communication.hpp is included. This allows the creation
of a PowerMonitorClient object. See Table 9 for available messages. All message objects use the Short Name
with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the PowerMonitorClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">PowerMonitorClient</span> <span class="nf">pwr</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>

    <span class="c1">// Initialize Serial (for displaying information on the terminal)</span>
    <span class="nf">Serial</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">float</span> <span class="n">voltage</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ser</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">pwr</span><span class="p">.</span><span class="n">volts_</span><span class="p">,</span><span class="n">voltage</span><span class="p">))</span>
    <span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">voltage</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id88">
<h4>C++<a class="headerlink" href="#id88" title="Permalink to this headline">¶</a></h4>
<p>To use Power Monitor in C++, include power monitor client.hpp. This allows the creation of a
PowerMonitorClient object. See Table 9 for available messages. All message objects use the Short Name with a trailing
underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the PowerMonitorClient is:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;power_monitor_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">float</span> <span class="n">volts</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Power Monitor object with obj_id 0</span>
    <span class="n">PowerMontitorClient</span> <span class="n">pwr</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Power Monitor object</span>
    <span class="n">pwr</span><span class="p">.</span><span class="n">volts_</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>
    <span class="c1">// Read response</span>
    <span class="n">volts</span> <span class="o">=</span> <span class="n">pwr</span><span class="p">.</span><span class="n">volts_</span><span class="p">.</span><span class="n">get_reply</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id89">
<h4>Matlab<a class="headerlink" href="#id89" title="Permalink to this headline">¶</a></h4>
<p>To use Power Monitor in Matlab, all IQ communication code must be included in your path. This allows
the creation of a PowerMonitorClient object. See Table 9 for available messages. All message strings use
the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the PowerMonitorClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a PowerMontitorClient object with obj_id 0</span><span class="w"></span>
<span class="n">pwr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">PowerMontitorClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the PowerMontitorClient object</span><span class="w"></span>
<span class="n">volts</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pwr</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>’<span class="n">volts</span>’<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id90">
<h4>Python<a class="headerlink" href="#id90" title="Permalink to this headline">¶</a></h4>
<p>To use the Power Monitor Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Power Monitor Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Power Monitor Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">volts</span> <span class="o">=</span> <span class="n">vertiq</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;power_monitor&quot;</span><span class="p">,</span> <span class="s2">&quot;volts&quot;</span><span class="p">)</span>  <span class="c1"># returns the input voltage to module</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Voltage coming into module: </span><span class="si">{</span><span class="n">volts</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id91">
<h4>Message Table<a class="headerlink" href="#id91" title="Permalink to this headline">¶</a></h4>
<p>Type ID 69 | Power Monitor</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 8%" />
<col style="width: 14%" />
<col style="width: 16%" />
<col style="width: 11%" />
<col style="width: 7%" />
<col style="width: 46%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>volts</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>Input voltage to module</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>amps</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>A</p></td>
<td><p>Input amperage to module</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>watts</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>W</p></td>
<td><p>Input wattage to module</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>joules</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>J</p></td>
<td><p>Total energy consumed by module</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>reset_joules</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Sets joules to zero</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>filter_fs</p></td>
<td><p>get</p></td>
<td><p>uint32</p></td>
<td><p>Hz</p></td>
<td><p>Low pass filter sample frequency</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>filter_fc</p></td>
<td><p>get, set, save</p></td>
<td><p>uint32</p></td>
<td><p>Hz</p></td>
<td><p>Low pass filter cutoff frequency</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>volts_raw</p></td>
<td><p>get</p></td>
<td><p>uint16</p></td>
<td><p>bit</p></td>
<td><p>ADC value for the voltage measurement</p></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>amps_raw</p></td>
<td><p>get</p></td>
<td><p>uint16</p></td>
<td><p>bit</p></td>
<td><p>ADC value for the current measurement</p></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>volts_gain</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>V/bit</p></td>
<td><p>Gain for the ADC to voltage conversion</p></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p>amps_gain</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>A/bit</p></td>
<td><p>Gain for the ADC to current conversion</p></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p>amps_bias</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>bit</p></td>
<td><p>Offset bias for the ADC to current conversion</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="id92">
<h3>Serial Interface<a class="headerlink" href="#id92" title="Permalink to this headline">¶</a></h3>
<p>The Serial client allows the user to change settings related to the serial communication interface, namely
the baud rate. The set function of the baud rate behaves as both a set then a save. This allows the user to
set and save using the initial baud rate, rather than having to disconnect and reconnect using the new baud
rate in order to send a save. For this reason, the standard save function for the baud rate is disabled.</p>
<div class="section" id="id93">
<h4>Arduino<a class="headerlink" href="#id93" title="Permalink to this headline">¶</a></h4>
<p>To use Serial Interface in Arduino, ensure iq module communication.hpp is included. This allows the creation
of a SerialInterfaceClient object. See Table 8 for available messages. All message objects use the Short Name
with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the SerialInterfaceClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">SerialInterfaceClient</span> <span class="nf">sic</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">sic</span><span class="p">.</span><span class="n">baud_rate_</span><span class="p">,(</span><span class="kr">uint32_t</span><span class="p">)</span><span class="mi">9600</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To start from 9600 baud and reset the baud back to the default 115200, use:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">SerialInterfaceClient</span> <span class="nf">sic</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="mi">9600</span><span class="p">);</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">sic</span><span class="p">.</span><span class="n">baud_rate_</span><span class="p">,(</span><span class="kr">uint32_t</span><span class="p">)</span><span class="mi">115200</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id94">
<h4>C++<a class="headerlink" href="#id94" title="Permalink to this headline">¶</a></h4>
<p>To use Serial Interface in C++, include serial interface client.hpp. This allows the
creation of a SerialInterfaceClient object. See Table 8 for available messages. All
message objects use the Short Name with a trailing underscore.</p>
<p>A minimal working example for the SerialInterfaceClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;serial_interface_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">uint32_t</span> <span class="n">baud_rate</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Serial Interface object with obj_id 0</span>
    <span class="n">SerialInterfaceClient</span> <span class="n">serial_interface</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Serial Interface object</span>
    <span class="n">serial_interface</span><span class="p">.</span><span class="n">baud_rate_</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>
    <span class="c1">// baud_rate = serial_interface.baud_rate_.get_reply();</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id95">
<h4>Matlab<a class="headerlink" href="#id95" title="Permalink to this headline">¶</a></h4>
<p>To use Serial Interface in Matlab, all IQ communication code must be included in your path. This allows
the creation of a SerialInterfaceClient object. See Table 8 for available messages. All message strings use
the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the SerialInterfaceClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a Serial Interface object with obj_id 0</span><span class="w"></span>
<span class="n">serial_interface</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SerialInterfaceClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the Serial Interface object</span><span class="w"></span>
<span class="n">old_baud</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">serial_interface</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>’<span class="n">baud_rate</span>’<span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="mi">115200</span><span class="w"></span>
<span class="n">serial_interface</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">baud_rate</span>’<span class="p">,</span><span class="w"> </span><span class="mi">9600</span><span class="p">);</span><span class="w"></span>

<span class="c">% Note: the baud rate is now 9600. This com object uses 115200</span><span class="w"></span>

<span class="c">% Make a new com object at 9600 baud to continue communication</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">9600</span><span class="p">);</span><span class="w"></span>
<span class="n">serial_interface</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SerialInterfaceClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id96">
<h4>Python<a class="headerlink" href="#id96" title="Permalink to this headline">¶</a></h4>
<p>To use the Serial Interface Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Serial Interface Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Serial Interface Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;serial_interface&quot;</span><span class="p">,</span> <span class="s2">&quot;baud_rate&quot;</span><span class="p">,</span> <span class="mi">9600</span><span class="p">)</span>  <span class="c1"># change baud rate to 9600</span>
</pre></div>
</div>
</div>
<div class="section" id="id97">
<h4>Message Table<a class="headerlink" href="#id97" title="Permalink to this headline">¶</a></h4>
<p>Type ID 16 | Serial Interface</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 7%" />
<col style="width: 10%" />
<col style="width: 9%" />
<col style="width: 10%" />
<col style="width: 5%" />
<col style="width: 59%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>baud_rate</p></td>
<td><p>get, set</p></td>
<td><p>uint32</p></td>
<td><p>hz</p></td>
<td><p>Default is 115200. Reliable up to 2Mbps. Set also performs a save.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="step-direction-input">
<h3>Step Direction Input<a class="headerlink" href="#step-direction-input" title="Permalink to this headline">¶</a></h3>
<p>The Step Direction Input allows the module to accept commands normally used by stepper motor drivers.
One signal line controls the direction of motor rotation, while each rising and falling edge of the other line
advances the motor’s target angle by a user programmable amount. Steps can be as small as 1/65536th of a
rotation (9.5874e-05 radians). Step sizes that are a multiple of 1/65536th of a rotation will be exact, while
non-multiples will be floored to the nearest multiple. There is virtually no upper limit on the step size. Use
negative step sizes if the direction of the motor is reversed from desired.</p>
<div class="section" id="id98">
<h4>Arduino<a class="headerlink" href="#id98" title="Permalink to this headline">¶</a></h4>
<p>To use Step Direction Input in Arduino, ensure iq module communication.hpp is included. This allows the
creation of a StepDirectionInputClient object. See Table 7 for available messages. All message objects use
the Short Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the StepDirectionInputClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">StepDirectionInputClient</span> <span class="nf">sdi</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">sdi</span><span class="p">.</span><span class="n">angle_step_</span><span class="p">,</span><span class="mf">0.125f</span><span class="p">);</span> <span class="c1">// set to 8 edges per rotation</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">sdi</span><span class="p">.</span><span class="n">angle_step_</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id99">
<h4>C++<a class="headerlink" href="#id99" title="Permalink to this headline">¶</a></h4>
<p>To use Step Direction Input in C++, include step direction input.hpp. This allows the creation of a
StepDirectionInputClient object. See Table 7 for available messages. All message objects use the Short Name with
a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the StepDirectionInputClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;step_direction_input_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">float</span> <span class="n">angle_step</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Step Direction Input object with obj_id 0</span>
    <span class="n">StepDirectionInputClient</span> <span class="n">step_dir</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Step Direction Input object</span>
    <span class="n">step_dir</span><span class="p">.</span><span class="n">angle_step_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span><span class="mf">2.0f</span><span class="o">*</span><span class="n">PI</span><span class="o">/</span><span class="mf">65536.0f</span><span class="p">);</span> <span class="c1">// Set the minimum step angle</span>
    <span class="n">step_dir</span><span class="p">.</span><span class="n">angle_step_</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>
    <span class="n">step_dir</span><span class="p">.</span><span class="n">angle_step_</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>
    <span class="c1">// Read response</span>
    <span class="n">angle_step</span> <span class="o">=</span> <span class="n">step_dir</span><span class="p">.</span><span class="n">angle_step_</span><span class="p">.</span><span class="n">get_reply</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id100">
<h4>Matlab<a class="headerlink" href="#id100" title="Permalink to this headline">¶</a></h4>
<p>To use Step Direction in Matlab, all IQ communication code must be included in your path. This allows the
creation of a StepDirectionInputClient object. See Table 7 for available messages. All message strings use
the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the StepDirectionInputClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a MultiTurnAngleControlClient object with obj_id 0</span><span class="w"></span>
<span class="n">step_dir</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">StepDirectionInputClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the StepDirectionInputClient object</span><span class="w"></span>
<span class="n">angle_step</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">step_dir</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>’<span class="n">angle_step</span>’<span class="p">);</span><span class="w"></span>
<span class="n">step_dir</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">angle_step</span>’<span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">/</span><span class="mi">65536</span><span class="p">);</span><span class="w"></span>
<span class="n">step_dir</span><span class="p">.</span><span class="n">save</span><span class="p">(</span>’<span class="n">angle_step</span>’<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id101">
<h4>Python<a class="headerlink" href="#id101" title="Permalink to this headline">¶</a></h4>
<p>To use the Step Direction Input Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Step Direction Input Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Step Direction Input Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">firmware</span><span class="o">=</span><span class="s2">&quot;stepdir&quot;</span><span class="p">)</span>

<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;step_direction_input&quot;</span><span class="p">,</span> <span class="s2">&quot;angle_step&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">/</span><span class="mi">65536</span><span class="p">))</span>  <span class="c1"># Set min step angle</span>
</pre></div>
</div>
</div>
<div class="section" id="id102">
<h4>Message Table<a class="headerlink" href="#id102" title="Permalink to this headline">¶</a></h4>
<p>Type ID 58 | Step Direction Input</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 15%" />
<col style="width: 20%" />
<col style="width: 14%" />
<col style="width: 8%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>angle</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td><p>Current commanded angle</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>angle_step</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td><p>Angle step per step edge</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="id103">
<h3>System Control<a class="headerlink" href="#id103" title="Permalink to this headline">¶</a></h3>
<p>System Control allows the user to perform low level tasks on the motor controller’s microcontroller and gather
basic information. The motor’s uptime can be read and set, allowing for flexible timing and synchronizing.
System Control also has a Module ID parameter, which allows motors to be bussed on a single serial line yet
addressed uniquely. System Control is unique since its ID is always 0 even when the Module ID has been
changed.</p>
<div class="section" id="id104">
<h4>Arduino<a class="headerlink" href="#id104" title="Permalink to this headline">¶</a></h4>
<p>To use System Control in Arduino, ensure iq module communication.hpp is included. This allows the creation
of a SystemControlClient object. See Table 12 for available messages. All message objects use the Short
Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the SystemControlClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">SystemControlClient</span> <span class="nf">sys</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
    <span class="c1">// Initialize Serial (for displaying information on the terminal)</span>
    <span class="nf">Serial</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">float</span> <span class="n">sys_time</span> <span class="o">=</span> <span class="mf">0.0f</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ser</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">time_</span><span class="p">,</span><span class="n">sys_time</span><span class="p">))</span>
        <span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">sys_time</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id105">
<h4>C++<a class="headerlink" href="#id105" title="Permalink to this headline">¶</a></h4>
<p>To use System Control in C++, include system control client.hpp. This allows the creation
of a SystemControlClient object. See Table 12 for available messages. All message objects use the Short Name with a
trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the SystemControlClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;system_control_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">float</span> <span class="n">time</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a System Control object with obj_id 0</span>
    <span class="c1">// System Control objects are always obj_id 0</span>
    <span class="n">SystemControlClient</span> <span class="n">system_control</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the System Control object</span>
    <span class="n">system_control</span><span class="p">.</span><span class="n">time_</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>
    <span class="c1">// time = system_control.time_.get_reply();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id106">
<h4>Matlab<a class="headerlink" href="#id106" title="Permalink to this headline">¶</a></h4>
<p>To use System Control in Matlab, all IQ communication code must be included in your path. This allows
the creation of a SystemControlClient object. See Table 12 for available messages. All message strings use
the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the SystemControlClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a System Control object with obj_id 0</span><span class="w"></span>
<span class="c">% System Control objects are always obj_id 0</span><span class="w"></span>
<span class="n">system_control</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SystemControlClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the System Control object</span><span class="w"></span>
<span class="nb">time</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">system_control</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>’<span class="nb">time</span>’<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id107">
<h4>Python<a class="headerlink" href="#id107" title="Permalink to this headline">¶</a></h4>
<p>To use the System Control Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the System Control Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the System Control Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">FW</span> <span class="o">=</span> <span class="n">vertiq</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system_control&quot;</span><span class="p">,</span> <span class="s2">&quot;firmware_version&quot;</span><span class="p">)</span>  <span class="c1"># Firmware Version Number</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Firmware: </span><span class="si">{</span><span class="n">FW</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id108">
<h4>Message Table<a class="headerlink" href="#id108" title="Permalink to this headline">¶</a></h4>
<p>Type ID 5 | System Control</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 6%" />
<col style="width: 16%" />
<col style="width: 12%" />
<col style="width: 9%" />
<col style="width: 5%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>reboot_program</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Reboots the motor controller with saved values</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>reboot_boot_loader</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Reboots into the boot loader</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>dev_id</p></td>
<td><p>get</p></td>
<td><p>uint16</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>rev_id</p></td>
<td><p>get</p></td>
<td><p>uint16</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>uid1</p></td>
<td><p>get</p></td>
<td><p>uint32</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>uid2</p></td>
<td><p>get</p></td>
<td><p>uint32</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>uid3</p></td>
<td><p>get</p></td>
<td><p>uint32</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>mem_size</p></td>
<td><p>get</p></td>
<td><p>uint16</p></td>
<td><p>Kb</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>build_year</p></td>
<td><p>get</p></td>
<td><p>uint16</p></td>
<td><p>year</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>build_month</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>mon</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p>build_day</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>day</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p>build_hour</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>hour</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>12</p></td>
<td><p>build_minute</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>min</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>13</p></td>
<td><p>build_second</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>s</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>14</p></td>
<td><p>module_id</p></td>
<td><p>get, set, save</p></td>
<td><p>uint8</p></td>
<td><p>id</p></td>
<td><p>The ID used for all obj_id on this module</p></td>
</tr>
<tr class="row-odd"><td><p>15</p></td>
<td><p>time</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>s</p></td>
<td><p>Internal clock time. If unchanged through software this is uptime</p></td>
</tr>
<tr class="row-even"><td><p>16</p></td>
<td><p>firmware_version</p></td>
<td><p>get</p></td>
<td><p>uint32</p></td>
<td><p>ver</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>17</p></td>
<td><p>hardware_version</p></td>
<td><p>get, set, save</p></td>
<td><p>uint32</p></td>
<td><p>ver</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>18</p></td>
<td><p>electronics_version</p></td>
<td><p>get, set, save</p></td>
<td><p>uint32</p></td>
<td><p>ver</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>19</p></td>
<td><p>firmware_valid</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>bool</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="id109">
<h3>Temperature Estimator<a class="headerlink" href="#id109" title="Permalink to this headline">¶</a></h3>
<p>The Temperature Estimator uses a conduction thermal model to estimate the temperature of components
not directly sensed. In the motor modules the Temperature Estimator estimates the motor coil temperature.
The temperature is used to derate the motor if the temperature rises into dangerous levels. The temperature
limits can be adjusted, though this is not recommended.</p>
<div class="section" id="id110">
<h4>Arduino<a class="headerlink" href="#id110" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Estimator in Arduino, ensure iq module communication.hpp is included. This
allows the creation of a TemperatureEstimatorClient object. See Table 11 for available messages. All
message objects use the Short Name with a trailing underscore. All messages use the standard Get/Set/Save
functions.</p>
<p>A minimal working example for the TemperatureEstimatorClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">TemperatureEstimatorClient</span> <span class="nf">tmp</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
    <span class="c1">// Initialize Serial (for displaying information on the terminal)</span>
    <span class="nf">Serial</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">float</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mf">0.0f</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ser</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">temp_</span><span class="p">,</span><span class="n">temperature</span><span class="p">))</span>
    <span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">temperature</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id111">
<h4>C++<a class="headerlink" href="#id111" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Estimator client in C++, include temperature estimator client.hpp. This allows the
creation of a TemperatureEstimatorClient object. See Table 11 for available messages. All message objects
use the Short Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the TemperatureEstimatorClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;temperature_estimator_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">float</span> <span class="n">temp</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Temperature Estimator object with obj_id 0</span>
    <span class="n">TemperatureEstimatorClient</span> <span class="n">temp_client</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Temperature Estimator Client</span>
    <span class="n">temp_client</span><span class="p">.</span><span class="n">temp_</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">com</span><span class="p">)</span>

    <span class="c1">// [Insert code for interfacing with hardware here]</span>

    <span class="c1">// temp = temp_client.temp_.get_reply();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id112">
<h4>Matlab<a class="headerlink" href="#id112" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Estimator client in Matlab, all IQ communication code must be included in your
path. This allows the creation of a TemperatureEstimatorClient object. See Table 11 for available messages.
All message strings use the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the TemperatureEstimatorClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>
<span class="c">% Make an TemperatureEstimatorClient object with obj_id 0</span><span class="w"></span>
<span class="n">tes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">TemperatureEstimatorClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>
<span class="c">% Use the TemperatureEstimatorClient object</span><span class="w"></span>
<span class="n">coil_temp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tes</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>’<span class="n">temp</span>’<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id113">
<h4>Python<a class="headerlink" href="#id113" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Estimator Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Temperature Estimator Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Temperature Estimator Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">temp</span> <span class="o">=</span> <span class="n">vertiq</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;temperature_estimator&quot;</span><span class="p">,</span> <span class="s2">&quot;temp&quot;</span><span class="p">)</span>  <span class="c1"># Estimated Motor Temperature</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated Motor Temperature: </span><span class="si">{</span><span class="n">temp</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id114">
<h4>Message Table<a class="headerlink" href="#id114" title="Permalink to this headline">¶</a></h4>
<p>Type ID 77 | Temperature Estimator</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 5%" />
<col style="width: 12%" />
<col style="width: 9%" />
<col style="width: 6%" />
<col style="width: 3%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>temp</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>degC</p></td>
<td><p>Temperature of the motor coils</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>otw</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>degC</p></td>
<td><p>Over temperature warning. Derating of the motor begins at this temperature.</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>otlo</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>degC</p></td>
<td><p>Over temperature lock out. Derating of the motor end at this temperature, where the motor is fully disabled.</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>thermal_resistance</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>K/W</p></td>
<td><p>Model thermal resistance</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>thermal_capacitance</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>J/K</p></td>
<td><p>Model thermal capacitance</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>derate</p></td>
<td><p>get</p></td>
<td><p>Fix16</p></td>
<td><p>PU</p></td>
<td><p>Amount of derating applied to motor [0 65536] where 65536 is normal operation</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="id115">
<h3>Temperature Monitor UC<a class="headerlink" href="#id115" title="Permalink to this headline">¶</a></h3>
<p>The Temperature Monitor Microcontroller reads, filters, and reports the microcontroller’s internal temperature.
The temperature is used to derate the motor if the temperature rises into dangerous levels. The filter’s
cutoff frequency and the temperature limits can be adjusted, though this is not recommended.</p>
<div class="section" id="id116">
<h4>Arduino<a class="headerlink" href="#id116" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Monitor Microcontroller in Arduino, ensure iq module communication.hpp is included.
This allows the creation of a TemperatureMonitorUcClient object. See Table 10 for available
messages. All message objects use the Short Name with a trailing underscore. All messages use the standard
Get/Set/Save functions.</p>
<p>A minimal working example for the TemperatureMonitorUcClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">TemperatureMonitorUcClient</span> <span class="nf">tmp</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
    <span class="c1">// Initialize Serial (for displaying information on the terminal)</span>
    <span class="nf">Serial</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">float</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mf">0.0f</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ser</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">uc_temp_</span><span class="p">,</span><span class="n">temperature</span><span class="p">))</span>
        <span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">temperature</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id117">
<h4>C++<a class="headerlink" href="#id117" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Monitor Microcontroller client in C++, include temperature monitor uc client.hpp.
This allows the creation of a TemperatureMonitorUcClient object. See Table 10 for available messages. All
message objects use the Short Name with a trailing underscore. All messages use the standard Get/Set/Save
functions.</p>
<p>A minimal working example for the TemperatureMonitorUcClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;temperature_monitor_uc_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">float</span> <span class="n">uc_temp</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Temperature Monitor Microcontroller object with obj_id 0</span>
    <span class="n">TemperatureMonitorUcClient</span> <span class="n">tuc</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Temperature Monitor Microcontroller object</span>
    <span class="n">tuc</span><span class="p">.</span><span class="n">uc_temp_</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>
    <span class="c1">// Read response</span>
    <span class="n">uc_temp</span> <span class="o">=</span> <span class="n">tuc</span><span class="p">.</span><span class="n">uc_temp_</span><span class="p">.</span><span class="n">get_reply</span><span class="p">();</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id118">
<h4>Matlab<a class="headerlink" href="#id118" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Monitor Microcontroller client in Matlab, all IQ communication code must be
included in your path. This allows the creation of a TemperatureMonitorUcClient object. See Table 10 for
available messages. All message strings use the Short Names. All messages use the standard Get/Set/Save
functions.</p>
<p>A minimal working example for the TemperatureMonitorUcClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make an TemperatureMonitorUcClient object with obj_id 0</span><span class="w"></span>
<span class="n">tuc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">TemperatureMonitorUcClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the TemperatureMonitorUcClient object</span><span class="w"></span>
<span class="n">uc_temp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tuc</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>’<span class="n">uc_temp</span>’<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id119">
<h4>Python<a class="headerlink" href="#id119" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Monitor Microcontroller Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Temperature Monitor Microcontroller Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Temperature Monitor Microcontroller Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">temp</span> <span class="o">=</span> <span class="n">vertiq</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;temperature_monitor_uc&quot;</span><span class="p">,</span> <span class="s2">&quot;uc_temp&quot;</span><span class="p">)</span>  <span class="c1"># Internal UC Temperature</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Internal UC temperature: </span><span class="si">{</span><span class="n">temp</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id120">
<h4>Message Table<a class="headerlink" href="#id120" title="Permalink to this headline">¶</a></h4>
<p>Type ID 73 | Temperature Monitor Microcontroller</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 5%" />
<col style="width: 7%" />
<col style="width: 10%" />
<col style="width: 7%" />
<col style="width: 4%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>uc_temp</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>degC</p></td>
<td><p>Temperature of the microcontroller</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>filter_fs</p></td>
<td><p>get</p></td>
<td><p>uint32</p></td>
<td><p>Hz</p></td>
<td><p>Low pass filter sample frequency</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>filter_fc</p></td>
<td><p>get, set, save</p></td>
<td><p>uint32</p></td>
<td><p>Hz</p></td>
<td><p>Low pass filter cutoff frequency</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>otw</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>degC</p></td>
<td><p>Over temperature warning. Derating of the motor begins at this temperature.</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>otlo</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>degC</p></td>
<td><p>Over temperature lock out. Derating of the motor end at this temperature, where the motor is fully disabled.</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>derate</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>PU</p></td>
<td><p>Amount of derating applied to motor [0 1]</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="speed-firmware">
<h2>Speed Firmware<a class="headerlink" href="#speed-firmware" title="Permalink to this headline">¶</a></h2>
<div class="section" id="propeller-motor-control">
<h3>Propeller Motor Control<a class="headerlink" href="#propeller-motor-control" title="Permalink to this headline">¶</a></h3>
<p>The Propeller Motor Controller is an open and closed loop controller designed to drive propeller loads. If
given thrust coefficients, this controller can be commanded in units of thrust, seamlessly accepting values
from flight controllers in their native units. An added benefit is the decoupling of flight controller gains
from motor choice, propeller choice, battery level, and more. Thrust commands are fed into a PID velocity
controller with a second order polynomial feed forward. This sits on top of a voltage controller, which
compensates for varying input voltages. Finally, the core is a raw PWM controller. Any of the above
controllers can be used by the user.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Propeller Motor Control will timeout and beep 3 times if it hasn’t received a command before the timeout is reached.
You can extend the timeout by changing the timeout client entry</p>
</div>
<div class="section" id="id121">
<h4>Arduino<a class="headerlink" href="#id121" title="Permalink to this headline">¶</a></h4>
<p>To use Propeller Motor Controller in Arduino, ensure iq module communication.hpp is included. This allows
the creation of a PropellerMotorControlClient object. See Table 2 for available messages. All message objects
use the Short Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the PropellerMotorControlMessaging is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communicaiton.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">PropellerMotorControlClient</span> <span class="nf">prop</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">prop</span><span class="p">.</span><span class="n">ctrl_velocity_</span><span class="p">,</span><span class="mf">50.0f</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id122">
<h4>C++<a class="headerlink" href="#id122" title="Permalink to this headline">¶</a></h4>
<p>To use Propeller Motor Controller in C++, include propeller motor control client.hpp. This allows the
creation of a PropellerMotorControlClient object. See Table 2 for available messages. All message objects
use the Short Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the PropellerMotorControlClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;propeller_motor_control_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">float</span> <span class="n">velocity</span> <span class="o">=</span> <span class="mf">100.0f</span><span class="p">;</span> <span class="c1">// rad/s</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Propeller Motor Controller object with obj_id 0</span>
    <span class="n">PropellerMotorControlClient</span> <span class="n">prop</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Propeller Motor Controller object</span>
    <span class="n">prop</span><span class="p">.</span><span class="n">ctrl_velocity_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="n">velocity</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id123">
<h4>Matlab<a class="headerlink" href="#id123" title="Permalink to this headline">¶</a></h4>
<p>To use Propeller Motor Controller in Matlab, all IQ communication code must be included in your path.
This allows the creation of a PropellerMotorControlClient object. See Table 2 for available messages. All
message strings use the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the PropellerMotorControlClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a PropellerMotorControlClient object with obj_id 0</span><span class="w"></span>
<span class="n">prop</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">PropellerMotorControlClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the PropellerMotorControlClient object</span><span class="w"></span>
<span class="n">prop</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">ctrl_velocity</span>’<span class="p">,</span><span class="mf">100.0</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id124">
<h4>Python<a class="headerlink" href="#id124" title="Permalink to this headline">¶</a></h4>
<p>To use the Propeller Motor Control Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Propeller Motor Control Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Propeller Motor Control Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;propeller_motor_control&quot;</span><span class="p">,</span> <span class="s2">&quot;ctrl_velocity&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># Supplies 5V to motor</span>
</pre></div>
</div>
</div>
<div class="section" id="id125">
<h4>Message Table<a class="headerlink" href="#id125" title="Permalink to this headline">¶</a></h4>
<p>Type ID 52 | Propeller Motor Controller</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 5%" />
<col style="width: 12%" />
<col style="width: 10%" />
<col style="width: 7%" />
<col style="width: 8%" />
<col style="width: 58%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p class="centered">
<strong>Note</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>ctrl_mode</p></td>
<td><p>get</p></td>
<td><p>int8</p></td>
<td><p>enum</p></td>
<td><p>-1 = no change, 0 = brake, 1 = coast, 2 = pwm, 3 = volts, 4 = velocity, 5 = thrust</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>ctrl_brake</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Shorts motor leads, slows motor down dissipating energy in motor</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>ctrl_coast</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Disables all drive circuitry</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>ctrl_pwm</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>PWM</p></td>
<td><p>[-1, 1] fraction of input voltage</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>ctrl_volts</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>[-supply, supply] Voltage to apply to motor</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>ctrl_velocity</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>rad/s</p></td>
<td><p>Angular velocity command</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>ctrl_thrust</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>N</p></td>
<td><p>Thrust command (requires kt values)</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>velocity_kp</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>V/(rad/s)</p></td>
<td><p>Proportional gain</p></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>velocity_ki</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>V/(rad)</p></td>
<td><p>Integral gain</p></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>velocity_kd</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>V/(rad/s2)</p></td>
<td><p>Derivative gain</p></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p>velocity_ff0</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>Feed forward 0th order term</p></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p>velocity_ff1</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>V/(rad/s)</p></td>
<td><p>Feed forward 1st order term</p></td>
</tr>
<tr class="row-even"><td><p>12</p></td>
<td><p>velocity_ff2</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>V/(rad/s)2</p></td>
<td><p>Feed forward 2nd order term</p></td>
</tr>
<tr class="row-odd"><td><p>13</p></td>
<td><p>propeller_kt_pos</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>N/(rad/s)2</p></td>
<td><p>T = ktω2thrust constant in positive direction</p></td>
</tr>
<tr class="row-even"><td><p>14</p></td>
<td><p>propeller_kt_neg</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>N/(rad/s)2</p></td>
<td><p>T = ktω2 thrust constant in negative direction</p></td>
</tr>
<tr class="row-odd"><td><p>15</p></td>
<td><p>timeout</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>s</p></td>
<td><p>The controller must receive a message within thistime otherwise it is set to coast mode</p></td>
</tr>
<tr class="row-even"><td><p>16</p></td>
<td><p>input_filter_fc</p></td>
<td><p>get, set, save</p></td>
<td><p>uint32</p></td>
<td><p>Hz</p></td>
<td><p>Low pass cutoff frequency for input commands</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="id126">
<h3>Brushless Drive<a class="headerlink" href="#id126" title="Permalink to this headline">¶</a></h3>
<p>Brushless Drive is the low level driver of the motor’s phase voltage.</p>
<div class="section" id="id127">
<h4>Arduino<a class="headerlink" href="#id127" title="Permalink to this headline">¶</a></h4>
<p>To use Brushless Drive in Arduino, ensure iq module communication.hpp is included. This allows the creation of a BrushlessDriveClient object.
See Table 3 for available messages. All message objects use the Short
Name with a trailing underscore. All messages use the standard <code class="docutils literal notranslate"><span class="pre">Get/Set/Save</span></code> functions.</p>
<p>A minimal working example for the BrushlessDriveClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communicaiton.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">BrushlessDriveClient</span> <span class="nf">mot</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">mot</span><span class="p">.</span><span class="n">drive_spin_volts_</span><span class="p">,</span><span class="mf">0.1f</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id128">
<h4>C++<a class="headerlink" href="#id128" title="Permalink to this headline">¶</a></h4>
<p>To use Brushless Drive in C++, include brushless drive client.hpp. This allows the creation of a <code class="docutils literal notranslate"><span class="pre">BrushlessDriveClient</span></code> object.
See Table 3 for available messages. All message objects use the Short Name with a trailing underscore. All messages use the standard <code class="docutils literal notranslate"><span class="pre">Get/Set/Save</span></code> functions.</p>
<p>A minimal working example for the BrushlessDriveClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;propeller_motor_control_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">float</span> <span class="n">voltage</span> <span class="o">=</span> <span class="mf">3.0f</span><span class="p">;</span> <span class="c1">// volts</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>

<span class="c1">// Make a communication interface object</span>
<span class="c1">// This is what creates and parses packets</span>
<span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

<span class="c1">// Make a Temperature Estimator Client object with obj_id 0</span>
<span class="n">BrushlessDriveClient</span> <span class="n">brushless</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="c1">// Drives the motor at 3 Volts</span>
<span class="n">brushless</span><span class="p">.</span><span class="n">drive_spin_volts_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="n">voltage</span><span class="p">);</span>

<span class="c1">// Insert code for interfacing with hardware here</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id129">
<h4>Matlab<a class="headerlink" href="#id129" title="Permalink to this headline">¶</a></h4>
<p>To use Brushless Drive Controller in Matlab, all IQ communication code must be included in your path.
This allows the creation of a BrushlessDriveClient object. See Table 2 for available messages. All
message strings use the Short Names. All messages use the standard <code class="docutils literal notranslate"><span class="pre">Get/Set/Save</span></code> functions.</p>
<p>A minimal working example for the BrushlessDriveClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a BrushlessDriveClient object with obj_id 0</span><span class="w"></span>
<span class="n">drive</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">BrushlessDriveClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the BrushlessDriveClient object</span><span class="w"></span>
<span class="n">drive</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">drive_spin_volts</span>’<span class="p">,</span><span class="mf">3.0</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id130">
<h4>Python<a class="headerlink" href="#id130" title="Permalink to this headline">¶</a></h4>
<p>To use the Brushless Drive Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Brushless Drive Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the BrushlessDriveClient is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;brushless_drive&quot;</span><span class="p">,</span> <span class="s2">&quot;drive_spin_volts&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># Spins motor at 5 volts</span>
</pre></div>
</div>
</div>
<div class="section" id="id131">
<h4>Message Table<a class="headerlink" href="#id131" title="Permalink to this headline">¶</a></h4>
<p>Type ID 50 | Brushless Drive</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 4%" />
<col style="width: 10%" />
<col style="width: 8%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 65%" />
<col style="width: 3%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>drive_mode</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td></td>
<td><p>0 = phase_pwm, 1 = phase_volts, 2 = spin_pwm, 3 = spin_volts, 4 = brake, 5 = coast</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>drive_phase_pwm</p></td>
<td><p>set</p></td>
<td><p>float</p></td>
<td><p>pwm</p></td>
<td><p>Open loop (gimbal) mode with this trottle [-1, 1].  Use with phase_angle.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>drive_phase_volts</p></td>
<td><p>set</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>Open loop (gimbal) mode with this voltage.  Use with phase_angle.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>drive_spin_pwm</p></td>
<td><p>set</p></td>
<td><p>float</p></td>
<td><p>pwm</p></td>
<td><p>Spins motor with this throttle [-1, 1]</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>drive_spin_volts</p></td>
<td><p>set</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>Spins motor with this voltage</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>drive_brake</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Shorts motor phases, slows motor down dissipating energy in motor</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>drive_coast</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Disables all drive circuitry, motor passively coasts</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>drive_angle_offset</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td><p>Analogous to motor timing. This is internally computed by the motor.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>drive_pwm</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>pwm</p></td>
<td><p>The applied pwm after all computation and limiting [-1, 1]</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>drive_volts</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>The applied pwm after all computation and limiting</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p>mech_lead_angle</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p>obs_supply_volts</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>Observed supply voltage</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>12</p></td>
<td><p>obs_angle</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td><p>Observed motor angle</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>13</p></td>
<td><p>obs_velocity</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>rad/s</p></td>
<td><p>Observed motor velocity</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>14</p></td>
<td><p>motor_pole_pairs</p></td>
<td><p>get, set, save</p></td>
<td><p>uint16</p></td>
<td></td>
<td><p>Number of motor pole pairs (magnets/2)</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>15</p></td>
<td><p>motor_emf_shape</p></td>
<td><p>get, set, save</p></td>
<td><p>uint8</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>16</p></td>
<td><p>permute_wires</p></td>
<td><p>get, set, save</p></td>
<td><p>uint8</p></td>
<td><p>bool</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>17</p></td>
<td><p>calibration_angle</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>18</p></td>
<td><p>lead_time</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>s</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>19</p></td>
<td><p>commutation_hz</p></td>
<td><p>get, set, save</p></td>
<td><p>uint32</p></td>
<td><p>Hz</p></td>
<td><p>Frequency of commutation.  Higher frequencies run faster and more efficient, but may not give the controller enough computation time.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>20</p></td>
<td><p>phase_angle</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>rad</p></td>
<td><p>Angle used for open loop (gimbal) mode. Use with drive_phase_pwm or drive_phase_volts</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>32</p></td>
<td><p>motor_Kv</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>RPM/V</p></td>
<td><p>Motor’s voltage constant</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>33</p></td>
<td><p>motor_R_ohm</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>ohm</p></td>
<td><p>Motor’s resistance</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>34</p></td>
<td><p>motor_I_max</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>A</p></td>
<td><p>Max allowable motor current</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>35</p></td>
<td><p>volts_limit</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>Max regen voltage</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>36</p></td>
<td><p>est_motor_amps</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>A</p></td>
<td><p>Estimated motor amps</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>37</p></td>
<td><p>est_motor_torque</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>Nm</p></td>
<td><p>Estimated motor torque</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>38</p></td>
<td><p>motor_redline_start</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>rad/s</p></td>
<td><p>Speed at which motor begins to derate</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>39</p></td>
<td><p>motor_redline_end</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>rad/s</p></td>
<td><p>Speed at which the motor is fully derated</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>40</p></td>
<td><p>motor_l</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>H</p></td>
<td><p>Cross inductance</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>41</p></td>
<td><p>derate</p></td>
<td><p>get</p></td>
<td><p>int32</p></td>
<td><p>PU fix16</p></td>
<td><p>Amount of derating.  No derate = 65536, full derate = 0</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>42</p></td>
<td><p>i_soft_start</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>A</p></td>
<td><p>Current at which motor begins to derate</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>43</p></td>
<td><p>i_soft_end</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>A</p></td>
<td><p>Current at which the motor is fully derated</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="id132">
<h3>Buzzer Control<a class="headerlink" href="#id132" title="Permalink to this headline">¶</a></h3>
<p>The Buzzer Control handles all beeps and songs played by the motor. The controls mimic standard MIDI
commands allowing simple translation from MIDI to Buzzer Control commands. The volume max parameter
controls the absolute volume across all notes, measured in volts. To play a note on the buzzer, set the
frequency by sending a ’hz’ command, set a relative volume by sending a ’volume’ command, set a note
length by sending a ’duration’ command, and finally put the controller in note mode by sending ’ctrl note’.</p>
<div class="section" id="id133">
<h4>Arduino<a class="headerlink" href="#id133" title="Permalink to this headline">¶</a></h4>
<p>To use the Buzzer Control in Arduino, ensure iq module communication.hpp is included. This allows the
creation of a BuzzerControlClient object. See Table 5 for available messages. All message objects use the
Short Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the BuzzerControlClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">BuzzerControlClient</span> <span class="nf">buz</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">buz</span><span class="p">.</span><span class="n">hz_</span><span class="p">,(</span><span class="kr">uint16_t</span><span class="p">)</span><span class="mi">1000</span><span class="p">);</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">buz</span><span class="p">.</span><span class="n">volume_</span><span class="p">,(</span><span class="kr">uint8_t</span><span class="p">)</span><span class="mi">127</span><span class="p">);</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">buz</span><span class="p">.</span><span class="n">duration_</span><span class="p">,(</span><span class="kr">uint16_t</span><span class="p">)</span><span class="mi">500</span><span class="p">);</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">buz</span><span class="p">.</span><span class="n">ctrl_note_</span><span class="p">);</span>
    <span class="nf">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id134">
<h4>C++<a class="headerlink" href="#id134" title="Permalink to this headline">¶</a></h4>
<p>To use the Buzzer Control in C++, include buzzer control client.hpp. This allows the creation of a
BuzzerControlClient object. See Table 5 for available messages. All message objects use the Short Name with a
trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the BuzzerControlClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;buzzer_control_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Buzzer Control object with obj_id 0</span>
    <span class="n">BuzzerControlClient</span> <span class="n">buz</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Buzzer Control object</span>
    <span class="n">buz</span><span class="p">.</span><span class="n">hz_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">440</span><span class="p">);</span> <span class="c1">// A4</span>
    <span class="n">buz</span><span class="p">.</span><span class="n">volume_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">127</span><span class="p">);</span> <span class="c1">// Max volume</span>
    <span class="n">buz</span><span class="p">.</span><span class="n">duration_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span> <span class="c1">// 500ms</span>
    <span class="n">buz</span><span class="p">.</span><span class="n">ctrl_note_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">);</span> <span class="c1">// Note mode</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id135">
<h4>Matlab<a class="headerlink" href="#id135" title="Permalink to this headline">¶</a></h4>
<p>To use the Buzzer Contol in Matlab, all IQ communication code must be included in your path. This allows
the creation of a BuzzerControlClient object. See Table 5 for available messages. All message strings use
the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the BuzzerControlClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a BuzzerControlClient object with obj_id 0</span><span class="w"></span>
<span class="n">buz</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">BuzzerControlClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the BuzzerControlClient object</span><span class="w"></span>
<span class="n">buz</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">hz</span>’<span class="p">,</span><span class="mi">440</span><span class="p">);</span><span class="w"> </span><span class="c">% A4</span><span class="w"></span>
<span class="n">buz</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="nb">volume</span>’<span class="p">,</span><span class="mi">127</span><span class="p">);</span><span class="w"> </span><span class="c">% Max volume</span><span class="w"></span>
<span class="n">buz</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="nb">duration</span>’<span class="p">,</span><span class="mi">500</span><span class="p">);</span><span class="w"> </span><span class="c">% 500ms</span><span class="w"></span>
<span class="n">buz</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">ctrl_note</span>’<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id136">
<h4>Python<a class="headerlink" href="#id136" title="Permalink to this headline">¶</a></h4>
<p>To use the Buzzer Control Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Buzzer Control Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Buzzer Control Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;buzzer_control&quot;</span><span class="p">,</span> <span class="s2">&quot;hz&quot;</span><span class="p">,</span> <span class="mi">440</span><span class="p">)</span>         <span class="c1"># A4</span>
<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;buzzer_control&quot;</span><span class="p">,</span> <span class="s2">&quot;volume&quot;</span><span class="p">,</span> <span class="mi">127</span><span class="p">)</span>     <span class="c1"># Max Volume</span>
<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;buzzer_control&quot;</span><span class="p">,</span> <span class="s2">&quot;duration&quot;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>  <span class="c1"># 1000ms</span>
<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;buzzer_control&quot;</span><span class="p">,</span> <span class="s2">&quot;ctrl_note&quot;</span><span class="p">)</span>       <span class="c1"># Start the Note</span>
</pre></div>
</div>
</div>
<div class="section" id="id137">
<h4>Message Table<a class="headerlink" href="#id137" title="Permalink to this headline">¶</a></h4>
<p>Type ID 61 | Buzzer Control</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 7%" />
<col style="width: 10%" />
<col style="width: 13%" />
<col style="width: 9%" />
<col style="width: 6%" />
<col style="width: 55%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>ctrl_mode</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>enum</p></td>
<td><p>no_change = -1, brake=0, coast=1, note=2, song=3</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>ctrl_brake</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Shorts motor phases, slows motor down dissipating energy in motor</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>ctrl_coast</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Disables all drive circuitry, motor passively coasts</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>ctrl_note</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Must have sent a ‘hz’ and ‘volume’ first</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>volume_max</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>Uses this voltage command for maximum volume</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>hz</p></td>
<td><p>get, set</p></td>
<td><p>uint16</p></td>
<td><p>hz</p></td>
<td><p>Frequency of the note</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>volume</p></td>
<td><p>get, set</p></td>
<td><p>uint8</p></td>
<td><p>0-127</p></td>
<td><p>Individual note volume as fraction of 127</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>duration</p></td>
<td><p>get, set</p></td>
<td><p>uint16</p></td>
<td><p>ms</p></td>
<td><p>Note length.  Assumed max (65535 ms) if not sent.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="esc-propeller-input-parser">
<h3>ESC Propeller Input Parser<a class="headerlink" href="#esc-propeller-input-parser" title="Permalink to this headline">¶</a></h3>
<p>The ESC Propeller Input Parser is an interface between the Propeller Motor Controller and the PWM based
inputs like 1-2ms, OneShot, MultiShot, and DShot. This parser allows the user to control how ratiomatic
values from the PWM input are translated. Inputs can be mapped to PWM control, voltage control, velocity
control, and thrust control. Values can be interpreted as signed/unsigned and clockwise/counter clockwise.</p>
<div class="section" id="id138">
<h4>Arduino<a class="headerlink" href="#id138" title="Permalink to this headline">¶</a></h4>
<p>To use ESC Propeller Input Parser in Arduino, ensure iq module communication.hpp is included. This
allows the creation of a EscPropellerInputParserClient object. See Table 6 for available messages. All
message objects use the Short Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the EscPropellerInputParserClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">EscPropellerInputParserClient</span> <span class="nf">esc</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
    <span class="c1">// Initialize Serial (for displaying information on the terminal)</span>
    <span class="nf">Serial</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">float</span> <span class="n">vel_max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">esc</span><span class="p">.</span><span class="n">velocity_max_</span><span class="p">,</span><span class="n">vel_max</span><span class="p">);</span>
    <span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">vel_max</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id139">
<h4>C++<a class="headerlink" href="#id139" title="Permalink to this headline">¶</a></h4>
<p>To use ESC Propeller Input Parser in C++, include esc propeller input parser client.hpp. This allows the
creation of a EscPropellerInputParserClient object. See Table 6 for available messages. All message objects
use the Short Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the EscPropellerInputParserClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;esc_propeller_input_parser_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">float</span> <span class="n">velocity_max</span> <span class="o">=</span> <span class="mf">1000.0f</span><span class="p">;</span> <span class="c1">// rad/s</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a ESC Propeller Input Parser object with obj_id 0</span>
    <span class="n">EscPropellerInputParserClient</span> <span class="n">esc</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the ESC Propeller Input Parser object</span>
    <span class="n">esc</span><span class="p">.</span><span class="n">velocity_max_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="n">velocity_max</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id140">
<h4>Matlab<a class="headerlink" href="#id140" title="Permalink to this headline">¶</a></h4>
<p>To use ESC Propeller Input Parser in Matlab, all IQ communication code must be included in your path.
This allows the creation of a EscPropellerInputParserClient object. See Table 6 for available messages. All
message strings use the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the EscPropellerInputParserClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a EscPropellerInputParserClient object with obj_id 0</span><span class="w"></span>
<span class="n">esc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">EscPropellerInputParserClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the EscPropellerInputParserClient object</span><span class="w"></span>
<span class="n">esc</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">velocity_max</span>’<span class="p">,</span><span class="mi">1000</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id141">
<h4>Python<a class="headerlink" href="#id141" title="Permalink to this headline">¶</a></h4>
<p>To use the ESC Propeller Input Parser Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the ESC Propeller Input Parser Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the ESC Propeller Input Parser Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;esc_propeller_input_parser&quot;</span><span class="p">,</span> <span class="s2">&quot;velocity_max&quot;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="c1"># Set max Velocity to 1000rad/s</span>
</pre></div>
</div>
</div>
<div class="section" id="id142">
<h4>Message Table<a class="headerlink" href="#id142" title="Permalink to this headline">¶</a></h4>
<p>Type ID 60 | ESC Propeller Input Parser</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 5%" />
<col style="width: 8%" />
<col style="width: 10%" />
<col style="width: 7%" />
<col style="width: 4%" />
<col style="width: 66%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>mode</p></td>
<td><p>get, set, save</p></td>
<td><p>uint8</p></td>
<td><p>enum</p></td>
<td><p>0 = PWM, 1 = Voltage, 2 = Velocity, 3 = Thrust</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>raw_value</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>PU</p></td>
<td><p>Input value [0, 1]</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>map</p></td>
<td><p>get, set, save</p></td>
<td><p>uint8</p></td>
<td><p>enum</p></td>
<td><p>0 = linear, 1 = sqrt</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>sign</p></td>
<td><p>get, set, save</p></td>
<td><p>uint8</p></td>
<td><p>enum</p></td>
<td><p>0 = unconfigured, 1 = signed positive, 2 = signed negative, 3 = unsigned positive, 4 = unsigned negative</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>volts_max</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>Maximum voltage to apply to motor, raw_value scaled to [-volts_max, volts_max] or [0, volts_max]</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>velocity_max</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>rad/s</p></td>
<td><p>Maximum angular velocity command, raw_value scaled to [-velocity_max, velocity_max] or [0, velocity_max]</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>thrust_max</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>N</p></td>
<td><p>Maximum thrust command (requires kt values), raw_value scaled to [-thrust_max, thrust_max] or [0, thrust_max]</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="id143">
<h3>Hobby Input<a class="headerlink" href="#id143" title="Permalink to this headline">¶</a></h3>
<p>The Hobby Input gives the module the ability to read in a variety of hobby communication protocols.
Supported protocols are standard 1-2ms PWM, OneShot125, OneShot42, MultiShot, and DShot (150 -
1200). The protocols are autodetected by default, but can be set to accept a single specific protocol. The
values read by the Hobby Input are fed into a Parser object, such as the Servo Parser or the ESC Parser.</p>
<div class="section" id="id144">
<h4>Arduino<a class="headerlink" href="#id144" title="Permalink to this headline">¶</a></h4>
<p>To use Hobby Input in Arduino, ensure iq module communication.hpp is included. This allows the creation
of a HobbyInputClient object. See Table 7 for available messages. All message objects use the Short Name
with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the HobbyInputClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">HobbyInputClient</span> <span class="nf">hin</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">hin</span><span class="p">.</span><span class="n">allowed_protocols_</span><span class="p">,(</span><span class="kr">uint8_t</span><span class="p">)</span><span class="mi">6</span><span class="p">);</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">hin</span><span class="p">.</span><span class="n">allowed_protocols_</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id145">
<h4>C++<a class="headerlink" href="#id145" title="Permalink to this headline">¶</a></h4>
<p>To use Hobby Input in C++, include hobby input client.hpp. This allows the creation of a HobbyInputClient
object. See Table 7 for available messages. All message objects use the Short Name with a trailing underscore.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the HobbyInputClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;hobby_input_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Hobby Input object with obj_id 0</span>
    <span class="n">HobbyInputClient</span> <span class="n">hin</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Hobby Input object</span>
    <span class="n">hin</span><span class="p">.</span><span class="n">allowed_protocols_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="c1">// Set the protocol to OneShot42</span>
    <span class="n">hin</span><span class="p">.</span><span class="n">allowed_protocols_</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id146">
<h4>Matlab<a class="headerlink" href="#id146" title="Permalink to this headline">¶</a></h4>
<p>To use Hobby Input in Matlab, all IQ communication code must be included in your path. This allows the
creation of a Hobby Input object. See Table 7 for available messages. All message strings use the Short
Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the HobbyInputClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a HobbyInputClient object with obj_id 0</span><span class="w"></span>
<span class="n">hin</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">HobbyInputClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the EscPropellerInputParserClient object</span><span class="w"></span>
<span class="n">hin</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">allowed_protocols</span>’<span class="p">,</span><span class="mi">3</span><span class="p">);</span><span class="w"></span>
<span class="n">hin</span><span class="p">.</span><span class="n">save</span><span class="p">(</span>’<span class="n">allowed_protocols</span>’<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id147">
<h4>Python<a class="headerlink" href="#id147" title="Permalink to this headline">¶</a></h4>
<p>To use the Hobby Input Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Hobby Input Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Hobby Input Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;hobby_input&quot;</span><span class="p">,</span> <span class="s2">&quot;allowed_protocols&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>   <span class="c1"># Set the protocol to MultiShot</span>
<span class="n">vertiq</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;hobby_input&quot;</span><span class="p">,</span> <span class="s2">&quot;allowed_protocols&quot;</span><span class="p">)</span>     <span class="c1"># Save the protocol</span>
</pre></div>
</div>
</div>
<div class="section" id="id148">
<h4>Message Table<a class="headerlink" href="#id148" title="Permalink to this headline">¶</a></h4>
<p>Type ID 76 | Hobby Input</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 6%" />
<col style="width: 15%" />
<col style="width: 13%" />
<col style="width: 9%" />
<col style="width: 5%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>allowed_protocols</p></td>
<td><p>get, set, save</p></td>
<td><p>uint8</p></td>
<td><p>enum</p></td>
<td><p>Standard PWM = 1, OneShot125 = 2, OneShot42 = 3, MultiShot = 4,</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>protocol</p></td>
<td><p>get, set, save</p></td>
<td><p>uint8</p></td>
<td><p>enum</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="id149">
<h3>Persistent Memory<a class="headerlink" href="#id149" title="Permalink to this headline">¶</a></h3>
<p>The Persistent Memory class controls the non-volatile memory. You can use this class to revert the motor
to factory defaults.</p>
<div class="section" id="id150">
<h4>Arduino<a class="headerlink" href="#id150" title="Permalink to this headline">¶</a></h4>
<p>To use Persistent Memory in Arduino, ensure iq module communication.hpp is included. This allows the
creation of a PersistentMemoryClient object. See Table 13 for available messages. All message objects use
the Short Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the PersistentMemoryClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">PersistentMemoryClient</span> <span class="nf">mem</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">mem</span><span class="p">.</span><span class="n">revert_to_default_</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id151">
<h4>C++<a class="headerlink" href="#id151" title="Permalink to this headline">¶</a></h4>
<p>To use Persistent Memory in C++, include persistent memory client.hpp. This allows the creation of a
PersistentMemoryClient object. See Table 13 for available messages. All message objects use the Short
Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the PersistentMemoryClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;persistent_memory_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Persistent Memory object with obj_id 0</span>
    <span class="n">PersistentMemoryClient</span> <span class="n">mem</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Persistent Memory object</span>
    <span class="n">mem</span><span class="p">.</span><span class="n">revert_to_default_</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id152">
<h4>Matlab<a class="headerlink" href="#id152" title="Permalink to this headline">¶</a></h4>
<p>To use Persistent Memory in Matlab, all IQ communication code must be included in your path. This allows
the creation of a PersistentMemoryClient object. See Table 13 for available messages. All message strings
use the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the PersistentMemoryClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a PersistentMemoryClient object with obj_id 0</span><span class="w"></span>
<span class="n">mem</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">PersistentMemoryClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the PersistentMemoryClient object</span><span class="w"></span>
<span class="n">mem</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">revert_to_default</span>’<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id153">
<h4>Python<a class="headerlink" href="#id153" title="Permalink to this headline">¶</a></h4>
<p>To use the Persistent Memory Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Persistent Memory Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Persistent Memory Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;persistent_memory&quot;</span><span class="p">,</span> <span class="s2">&quot;revert_to_default&quot;</span><span class="p">)</span>  <span class="c1"># erases saved values except for factory defaults</span>
</pre></div>
</div>
</div>
<div class="section" id="id154">
<h4>Message Table<a class="headerlink" href="#id154" title="Permalink to this headline">¶</a></h4>
<p>Type ID 11 | Persistent Memory</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 5%" />
<col style="width: 13%" />
<col style="width: 5%" />
<col style="width: 8%" />
<col style="width: 4%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>erase</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Erases all saved values including calibration data and product key.  Highly not recommended.</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>revert_to_default</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Erases all saved values except for those set in factory.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="id155">
<h3>Power Monitor<a class="headerlink" href="#id155" title="Permalink to this headline">¶</a></h3>
<p>The Power Monitor measures the power coming into the module. It reports input voltage and current as
well as calculates power and energy consumed. A built in low pass filter with adjustable cutoff frequency
smooths these values.</p>
<div class="section" id="id156">
<h4>Arduino<a class="headerlink" href="#id156" title="Permalink to this headline">¶</a></h4>
<p>To use Power Monitor in Arduino, ensure iq module communication.hpp is included. This allows the creation
of a PowerMonitorClient object. See Table 9 for available messages. All message objects use the Short Name
with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the PowerMonitorClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">PowerMonitorClient</span> <span class="nf">pwr</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>

    <span class="c1">// Initialize Serial (for displaying information on the terminal)</span>
    <span class="nf">Serial</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">float</span> <span class="n">voltage</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ser</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">pwr</span><span class="p">.</span><span class="n">volts_</span><span class="p">,</span><span class="n">voltage</span><span class="p">))</span>
    <span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">voltage</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id157">
<h4>C++<a class="headerlink" href="#id157" title="Permalink to this headline">¶</a></h4>
<p>To use Power Monitor in C++, include power monitor client.hpp. This allows the creation of a
PowerMonitorClient object. See Table 9 for available messages. All message objects use the Short Name with a trailing
underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the PowerMonitorClient is:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;power_monitor_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">float</span> <span class="n">volts</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Power Monitor object with obj_id 0</span>
    <span class="n">PowerMontitorClient</span> <span class="n">pwr</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Power Monitor object</span>
    <span class="n">pwr</span><span class="p">.</span><span class="n">volts_</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>
    <span class="c1">// Read response</span>
    <span class="n">volts</span> <span class="o">=</span> <span class="n">pwr</span><span class="p">.</span><span class="n">volts_</span><span class="p">.</span><span class="n">get_reply</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id158">
<h4>Matlab<a class="headerlink" href="#id158" title="Permalink to this headline">¶</a></h4>
<p>To use Power Monitor in Matlab, all IQ communication code must be included in your path. This allows
the creation of a PowerMonitorClient object. See Table 9 for available messages. All message strings use
the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the PowerMonitorClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a PowerMontitorClient object with obj_id 0</span><span class="w"></span>
<span class="n">pwr</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">PowerMontitorClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the PowerMontitorClient object</span><span class="w"></span>
<span class="n">volts</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">pwr</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>’<span class="n">volts</span>’<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id159">
<h4>Python<a class="headerlink" href="#id159" title="Permalink to this headline">¶</a></h4>
<p>To use the Power Monitor Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Power Monitor Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Power Monitor Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">volts</span> <span class="o">=</span> <span class="n">vertiq</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;power_monitor&quot;</span><span class="p">,</span> <span class="s2">&quot;volts&quot;</span><span class="p">)</span>  <span class="c1"># returns the input voltage to module</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Voltage coming into module: </span><span class="si">{</span><span class="n">volts</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id160">
<h4>Message Table<a class="headerlink" href="#id160" title="Permalink to this headline">¶</a></h4>
<p>Type ID 69 | Power Monitor</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 8%" />
<col style="width: 14%" />
<col style="width: 16%" />
<col style="width: 11%" />
<col style="width: 7%" />
<col style="width: 46%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>volts</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>V</p></td>
<td><p>Input voltage to module</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>amps</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>A</p></td>
<td><p>Input amperage to module</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>watts</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>W</p></td>
<td><p>Input wattage to module</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>joules</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>J</p></td>
<td><p>Total energy consumed by module</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>reset_joules</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Sets joules to zero</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>filter_fs</p></td>
<td><p>get</p></td>
<td><p>uint32</p></td>
<td><p>Hz</p></td>
<td><p>Low pass filter sample frequency</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>filter_fc</p></td>
<td><p>get, set, save</p></td>
<td><p>uint32</p></td>
<td><p>Hz</p></td>
<td><p>Low pass filter cutoff frequency</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>volts_raw</p></td>
<td><p>get</p></td>
<td><p>uint16</p></td>
<td><p>bit</p></td>
<td><p>ADC value for the voltage measurement</p></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>amps_raw</p></td>
<td><p>get</p></td>
<td><p>uint16</p></td>
<td><p>bit</p></td>
<td><p>ADC value for the current measurement</p></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>volts_gain</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>V/bit</p></td>
<td><p>Gain for the ADC to voltage conversion</p></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p>amps_gain</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>A/bit</p></td>
<td><p>Gain for the ADC to current conversion</p></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p>amps_bias</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>bit</p></td>
<td><p>Offset bias for the ADC to current conversion</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="id161">
<h3>Serial Interface<a class="headerlink" href="#id161" title="Permalink to this headline">¶</a></h3>
<p>The Serial client allows the user to change settings related to the serial communication interface, namely
the baud rate. The set function of the baud rate behaves as both a set then a save. This allows the user to
set and save using the initial baud rate, rather than having to disconnect and reconnect using the new baud
rate in order to send a save. For this reason, the standard save function for the baud rate is disabled.</p>
<div class="section" id="id162">
<h4>Arduino<a class="headerlink" href="#id162" title="Permalink to this headline">¶</a></h4>
<p>To use Serial Interface in Arduino, ensure iq module communication.hpp is included. This allows the creation
of a SerialInterfaceClient object. See Table 8 for available messages. All message objects use the Short Name
with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the SerialInterfaceClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">SerialInterfaceClient</span> <span class="nf">sic</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">sic</span><span class="p">.</span><span class="n">baud_rate_</span><span class="p">,(</span><span class="kr">uint32_t</span><span class="p">)</span><span class="mi">9600</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To start from 9600 baud and reset the baud back to the default 115200, use:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">SerialInterfaceClient</span> <span class="nf">sic</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="mi">9600</span><span class="p">);</span>
    <span class="n">ser</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">sic</span><span class="p">.</span><span class="n">baud_rate_</span><span class="p">,(</span><span class="kr">uint32_t</span><span class="p">)</span><span class="mi">115200</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id163">
<h4>C++<a class="headerlink" href="#id163" title="Permalink to this headline">¶</a></h4>
<p>To use Serial Interface in C++, include serial interface client.hpp. This allows the
creation of a SerialInterfaceClient object. See Table 8 for available messages. All
message objects use the Short Name with a trailing underscore.</p>
<p>A minimal working example for the SerialInterfaceClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;serial_interface_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">uint32_t</span> <span class="n">baud_rate</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Serial Interface object with obj_id 0</span>
    <span class="n">SerialInterfaceClient</span> <span class="n">serial_interface</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Serial Interface object</span>
    <span class="n">serial_interface</span><span class="p">.</span><span class="n">baud_rate_</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>
    <span class="c1">// baud_rate = serial_interface.baud_rate_.get_reply();</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id164">
<h4>Matlab<a class="headerlink" href="#id164" title="Permalink to this headline">¶</a></h4>
<p>To use Serial Interface in Matlab, all IQ communication code must be included in your path. This allows
the creation of a SerialInterfaceClient object. See Table 8 for available messages. All message strings use
the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the SerialInterfaceClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a Serial Interface object with obj_id 0</span><span class="w"></span>
<span class="n">serial_interface</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SerialInterfaceClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the Serial Interface object</span><span class="w"></span>
<span class="n">old_baud</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">serial_interface</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>’<span class="n">baud_rate</span>’<span class="p">);</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="mi">115200</span><span class="w"></span>
<span class="n">serial_interface</span><span class="p">.</span><span class="n">set</span><span class="p">(</span>’<span class="n">baud_rate</span>’<span class="p">,</span><span class="w"> </span><span class="mi">9600</span><span class="p">);</span><span class="w"></span>

<span class="c">% Note: the baud rate is now 9600. This com object uses 115200</span><span class="w"></span>

<span class="c">% Make a new com object at 9600 baud to continue communication</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">9600</span><span class="p">);</span><span class="w"></span>
<span class="n">serial_interface</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SerialInterfaceClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id165">
<h4>Python<a class="headerlink" href="#id165" title="Permalink to this headline">¶</a></h4>
<p>To use the Serial Interface Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Serial Interface Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Serial Interface Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">vertiq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;serial_interface&quot;</span><span class="p">,</span> <span class="s2">&quot;baud_rate&quot;</span><span class="p">,</span> <span class="mi">9600</span><span class="p">)</span>  <span class="c1"># change baud rate to 9600</span>
</pre></div>
</div>
</div>
<div class="section" id="id166">
<h4>Message Table<a class="headerlink" href="#id166" title="Permalink to this headline">¶</a></h4>
<p>Type ID 16 | Serial Interface</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 7%" />
<col style="width: 10%" />
<col style="width: 9%" />
<col style="width: 10%" />
<col style="width: 5%" />
<col style="width: 59%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>baud_rate</p></td>
<td><p>get, set</p></td>
<td><p>uint32</p></td>
<td><p>hz</p></td>
<td><p>Default is 115200. Reliable up to 2Mbps. Set also performs a save.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="id167">
<h3>System Control<a class="headerlink" href="#id167" title="Permalink to this headline">¶</a></h3>
<p>System Control allows the user to perform low level tasks on the motor controller’s microcontroller and gather
basic information. The motor’s uptime can be read and set, allowing for flexible timing and synchronizing.
System Control also has a Module ID parameter, which allows motors to be bussed on a single serial line yet
addressed uniquely. System Control is unique since its ID is always 0 even when the Module ID has been
changed.</p>
<div class="section" id="id168">
<h4>Arduino<a class="headerlink" href="#id168" title="Permalink to this headline">¶</a></h4>
<p>To use System Control in Arduino, ensure iq module communication.hpp is included. This allows the creation
of a SystemControlClient object. See Table 12 for available messages. All message objects use the Short
Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the SystemControlClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">SystemControlClient</span> <span class="nf">sys</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
    <span class="c1">// Initialize Serial (for displaying information on the terminal)</span>
    <span class="nf">Serial</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">float</span> <span class="n">sys_time</span> <span class="o">=</span> <span class="mf">0.0f</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ser</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">time_</span><span class="p">,</span><span class="n">sys_time</span><span class="p">))</span>
        <span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">sys_time</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id169">
<h4>C++<a class="headerlink" href="#id169" title="Permalink to this headline">¶</a></h4>
<p>To use System Control in C++, include system control client.hpp. This allows the creation
of a SystemControlClient object. See Table 12 for available messages. All message objects use the Short Name with a
trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the SystemControlClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;system_control_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">float</span> <span class="n">time</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a System Control object with obj_id 0</span>
    <span class="c1">// System Control objects are always obj_id 0</span>
    <span class="n">SystemControlClient</span> <span class="n">system_control</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the System Control object</span>
    <span class="n">system_control</span><span class="p">.</span><span class="n">time_</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>
    <span class="c1">// time = system_control.time_.get_reply();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id170">
<h4>Matlab<a class="headerlink" href="#id170" title="Permalink to this headline">¶</a></h4>
<p>To use System Control in Matlab, all IQ communication code must be included in your path. This allows
the creation of a SystemControlClient object. See Table 12 for available messages. All message strings use
the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the SystemControlClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make a System Control object with obj_id 0</span><span class="w"></span>
<span class="c">% System Control objects are always obj_id 0</span><span class="w"></span>
<span class="n">system_control</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">SystemControlClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the System Control object</span><span class="w"></span>
<span class="nb">time</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">system_control</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>’<span class="nb">time</span>’<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id171">
<h4>Python<a class="headerlink" href="#id171" title="Permalink to this headline">¶</a></h4>
<p>To use the System Control Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the System Control Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the System Control Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">FW</span> <span class="o">=</span> <span class="n">vertiq</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;system_control&quot;</span><span class="p">,</span> <span class="s2">&quot;firmware_version&quot;</span><span class="p">)</span>  <span class="c1"># Firmware Version Number</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Firmware: </span><span class="si">{</span><span class="n">FW</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id172">
<h4>Message Table<a class="headerlink" href="#id172" title="Permalink to this headline">¶</a></h4>
<p>Type ID 5 | System Control</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 6%" />
<col style="width: 16%" />
<col style="width: 12%" />
<col style="width: 9%" />
<col style="width: 5%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>reboot_program</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Reboots the motor controller with saved values</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>reboot_boot_loader</p></td>
<td><p>set</p></td>
<td></td>
<td></td>
<td><p>Reboots into the boot loader</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>dev_id</p></td>
<td><p>get</p></td>
<td><p>uint16</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>rev_id</p></td>
<td><p>get</p></td>
<td><p>uint16</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>uid1</p></td>
<td><p>get</p></td>
<td><p>uint32</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>uid2</p></td>
<td><p>get</p></td>
<td><p>uint32</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>uid3</p></td>
<td><p>get</p></td>
<td><p>uint32</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>mem_size</p></td>
<td><p>get</p></td>
<td><p>uint16</p></td>
<td><p>Kb</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>build_year</p></td>
<td><p>get</p></td>
<td><p>uint16</p></td>
<td><p>year</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>build_month</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>mon</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p>build_day</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>day</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p>build_hour</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>hour</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>12</p></td>
<td><p>build_minute</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>min</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>13</p></td>
<td><p>build_second</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>s</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>14</p></td>
<td><p>module_id</p></td>
<td><p>get, set, save</p></td>
<td><p>uint8</p></td>
<td><p>id</p></td>
<td><p>The ID used for all obj_id on this module</p></td>
</tr>
<tr class="row-odd"><td><p>15</p></td>
<td><p>time</p></td>
<td><p>get, set</p></td>
<td><p>float</p></td>
<td><p>s</p></td>
<td><p>Internal clock time. If unchanged through software this is uptime</p></td>
</tr>
<tr class="row-even"><td><p>16</p></td>
<td><p>firmware_version</p></td>
<td><p>get</p></td>
<td><p>uint32</p></td>
<td><p>ver</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>17</p></td>
<td><p>hardware_version</p></td>
<td><p>get, set, save</p></td>
<td><p>uint32</p></td>
<td><p>ver</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>18</p></td>
<td><p>electronics_version</p></td>
<td><p>get, set, save</p></td>
<td><p>uint32</p></td>
<td><p>ver</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>19</p></td>
<td><p>firmware_valid</p></td>
<td><p>get</p></td>
<td><p>uint8</p></td>
<td><p>bool</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="id173">
<h3>Temperature Estimator<a class="headerlink" href="#id173" title="Permalink to this headline">¶</a></h3>
<p>The Temperature Estimator uses a conduction thermal model to estimate the temperature of components
not directly sensed. In the motor modules the Temperature Estimator estimates the motor coil temperature.
The temperature is used to derate the motor if the temperature rises into dangerous levels. The temperature
limits can be adjusted, though this is not recommended.</p>
<div class="section" id="id174">
<h4>Arduino<a class="headerlink" href="#id174" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Estimator in Arduino, ensure iq module communication.hpp is included. This
allows the creation of a TemperatureEstimatorClient object. See Table 11 for available messages. All
message objects use the Short Name with a trailing underscore. All messages use the standard Get/Set/Save
functions.</p>
<p>A minimal working example for the TemperatureEstimatorClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">TemperatureEstimatorClient</span> <span class="nf">tmp</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
    <span class="c1">// Initialize Serial (for displaying information on the terminal)</span>
    <span class="nf">Serial</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">float</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mf">0.0f</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ser</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">temp_</span><span class="p">,</span><span class="n">temperature</span><span class="p">))</span>
    <span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">temperature</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id175">
<h4>C++<a class="headerlink" href="#id175" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Estimator client in C++, include temperature estimator client.hpp. This allows the
creation of a TemperatureEstimatorClient object. See Table 11 for available messages. All message objects
use the Short Name with a trailing underscore. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the TemperatureEstimatorClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;temperature_estimator_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">float</span> <span class="n">temp</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Temperature Estimator object with obj_id 0</span>
    <span class="n">TemperatureEstimatorClient</span> <span class="n">temp_client</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Temperature Estimator Client</span>
    <span class="n">temp_client</span><span class="p">.</span><span class="n">temp_</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">com</span><span class="p">)</span>

    <span class="c1">// [Insert code for interfacing with hardware here]</span>

    <span class="c1">// temp = temp_client.temp_.get_reply();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id176">
<h4>Matlab<a class="headerlink" href="#id176" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Estimator client in Matlab, all IQ communication code must be included in your
path. This allows the creation of a TemperatureEstimatorClient object. See Table 11 for available messages.
All message strings use the Short Names. All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the TemperatureEstimatorClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>
<span class="c">% Make an TemperatureEstimatorClient object with obj_id 0</span><span class="w"></span>
<span class="n">tes</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">TemperatureEstimatorClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>
<span class="c">% Use the TemperatureEstimatorClient object</span><span class="w"></span>
<span class="n">coil_temp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tes</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>’<span class="n">temp</span>’<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id177">
<h4>Python<a class="headerlink" href="#id177" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Estimator Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Temperature Estimator Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Temperature Estimator Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">temp</span> <span class="o">=</span> <span class="n">vertiq</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;temperature_estimator&quot;</span><span class="p">,</span> <span class="s2">&quot;temp&quot;</span><span class="p">)</span>  <span class="c1"># Estimated Motor Temperature</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated Motor Temperature: </span><span class="si">{</span><span class="n">temp</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id178">
<h4>Message Table<a class="headerlink" href="#id178" title="Permalink to this headline">¶</a></h4>
<p>Type ID 77 | Temperature Estimator</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 5%" />
<col style="width: 12%" />
<col style="width: 9%" />
<col style="width: 6%" />
<col style="width: 3%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>temp</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>degC</p></td>
<td><p>Temperature of the motor coils</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>otw</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>degC</p></td>
<td><p>Over temperature warning. Derating of the motor begins at this temperature.</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>otlo</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>degC</p></td>
<td><p>Over temperature lock out. Derating of the motor end at this temperature, where the motor is fully disabled.</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>thermal_resistance</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>K/W</p></td>
<td><p>Model thermal resistance</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>thermal_capacitance</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>J/K</p></td>
<td><p>Model thermal capacitance</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>derate</p></td>
<td><p>get</p></td>
<td><p>Fix16</p></td>
<td><p>PU</p></td>
<td><p>Amount of derating applied to motor [0 65536] where 65536 is normal operation</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="id179">
<h3>Temperature Monitor UC<a class="headerlink" href="#id179" title="Permalink to this headline">¶</a></h3>
<p>The Temperature Monitor Microcontroller reads, filters, and reports the microcontroller’s internal temperature.
The temperature is used to derate the motor if the temperature rises into dangerous levels. The filter’s
cutoff frequency and the temperature limits can be adjusted, though this is not recommended.</p>
<div class="section" id="id180">
<h4>Arduino<a class="headerlink" href="#id180" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Monitor Microcontroller in Arduino, ensure iq module communication.hpp is included.
This allows the creation of a TemperatureMonitorUcClient object. See Table 10 for available
messages. All message objects use the Short Name with a trailing underscore. All messages use the standard
Get/Set/Save functions.</p>
<p>A minimal working example for the TemperatureMonitorUcClient is:</p>
<div class="highlight-Arduino notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iq_module_communication.hpp&gt;</span><span class="cp"></span>

<span class="n">IqSerial</span> <span class="nf">ser</span><span class="p">(</span><span class="n">Serial2</span><span class="p">);</span>
<span class="n">TemperatureMonitorUcClient</span> <span class="nf">tmp</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="kr">void</span> <span class="nb">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ser</span><span class="p">.</span><span class="nf">begin</span><span class="p">();</span>
    <span class="c1">// Initialize Serial (for displaying information on the terminal)</span>
    <span class="nf">Serial</span><span class="p">.</span><span class="nf">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">void</span> <span class="nb">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">float</span> <span class="n">temperature</span> <span class="o">=</span> <span class="mf">0.0f</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ser</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">tmp</span><span class="p">.</span><span class="n">uc_temp_</span><span class="p">,</span><span class="n">temperature</span><span class="p">))</span>
        <span class="nf">Serial</span><span class="p">.</span><span class="nf">println</span><span class="p">(</span><span class="n">temperature</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id181">
<h4>C++<a class="headerlink" href="#id181" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Monitor Microcontroller client in C++, include temperature monitor uc client.hpp.
This allows the creation of a TemperatureMonitorUcClient object. See Table 10 for available messages. All
message objects use the Short Name with a trailing underscore. All messages use the standard Get/Set/Save
functions.</p>
<p>A minimal working example for the TemperatureMonitorUcClient is:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Interfacing with Serial looks different on different machines. Therefore,
this example does not include code for interfacing with the hardware.</p>
<p>For more, see <a class="reference internal" href="../langs/cpp.html#c-full-code"><span class="std std-ref">Full C++ Code Example (w/ LibSerial)</span></a></p>
</div>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;generic_interface.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;temperature_monitor_uc_client.hpp&quot;</span><span class="cp"></span>

<span class="kt">float</span> <span class="n">uc_temp</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="c1">// Make a communication interface object</span>
    <span class="n">GenericInterface</span> <span class="n">com</span><span class="p">;</span>

    <span class="c1">// Make a Temperature Monitor Microcontroller object with obj_id 0</span>
    <span class="n">TemperatureMonitorUcClient</span> <span class="n">tuc</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

    <span class="c1">// Use the Temperature Monitor Microcontroller object</span>
    <span class="n">tuc</span><span class="p">.</span><span class="n">uc_temp_</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">com</span><span class="p">);</span>

    <span class="c1">// Insert code for interfacing with hardware here</span>
    <span class="c1">// Read response</span>
    <span class="n">uc_temp</span> <span class="o">=</span> <span class="n">tuc</span><span class="p">.</span><span class="n">uc_temp_</span><span class="p">.</span><span class="n">get_reply</span><span class="p">();</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id182">
<h4>Matlab<a class="headerlink" href="#id182" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Monitor Microcontroller client in Matlab, all IQ communication code must be
included in your path. This allows the creation of a TemperatureMonitorUcClient object. See Table 10 for
available messages. All message strings use the Short Names. All messages use the standard Get/Set/Save
functions.</p>
<p>A minimal working example for the TemperatureMonitorUcClient is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Make a communication interface object</span><span class="w"></span>
<span class="n">com</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MessageInterface</span><span class="p">(</span>’<span class="n">COM18</span>’<span class="p">,</span><span class="mi">115200</span><span class="p">);</span><span class="w"></span>

<span class="c">% Make an TemperatureMonitorUcClient object with obj_id 0</span><span class="w"></span>
<span class="n">tuc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">TemperatureMonitorUcClient</span><span class="p">(</span>’<span class="n">com</span>’<span class="p">,</span><span class="n">com</span><span class="p">);</span><span class="w"></span>

<span class="c">% Use the TemperatureMonitorUcClient object</span><span class="w"></span>
<span class="n">uc_temp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tuc</span><span class="p">.</span><span class="n">get</span><span class="p">(</span>’<span class="n">uc_temp</span>’<span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id183">
<h4>Python<a class="headerlink" href="#id183" title="Permalink to this headline">¶</a></h4>
<p>To use the Temperature Monitor Microcontroller Client in Python, include <code class="docutils literal notranslate"><span class="pre">iqmotion</span></code> and create a module that has the Temperature Monitor Microcontroller Client within it’s firmware.
See Table below for available messages. All message strings use the Short Names.
All messages use the standard Get/Set/Save functions.</p>
<p>A minimal working example for the Temperature Monitor Microcontroller Client is:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">iqmotion</span> <span class="k">as</span> <span class="nn">iq</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">iq</span><span class="o">.</span><span class="n">SerialCommunicator</span><span class="p">(</span><span class="s2">&quot;/dev/ttyUSB0&quot;</span><span class="p">)</span>
<span class="n">vertiq</span> <span class="o">=</span> <span class="n">vertiq2306</span><span class="p">(</span><span class="n">com</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">temp</span> <span class="o">=</span> <span class="n">vertiq</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;temperature_monitor_uc&quot;</span><span class="p">,</span> <span class="s2">&quot;uc_temp&quot;</span><span class="p">)</span>  <span class="c1"># Internal UC Temperature</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Internal UC temperature: </span><span class="si">{</span><span class="n">temp</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id184">
<h4>Message Table<a class="headerlink" href="#id184" title="Permalink to this headline">¶</a></h4>
<p>Type ID 73 | Temperature Monitor Microcontroller</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 5%" />
<col style="width: 7%" />
<col style="width: 10%" />
<col style="width: 7%" />
<col style="width: 4%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sub ID</p></th>
<th class="head"><p>Short Name</p></th>
<th class="head"><p>Access</p></th>
<th class="head"><p>Data Type</p></th>
<th class="head"><p>Unit</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>uc_temp</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>degC</p></td>
<td><p>Temperature of the microcontroller</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>filter_fs</p></td>
<td><p>get</p></td>
<td><p>uint32</p></td>
<td><p>Hz</p></td>
<td><p>Low pass filter sample frequency</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>filter_fc</p></td>
<td><p>get, set, save</p></td>
<td><p>uint32</p></td>
<td><p>Hz</p></td>
<td><p>Low pass filter cutoff frequency</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>otw</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>degC</p></td>
<td><p>Over temperature warning. Derating of the motor begins at this temperature.</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>otlo</p></td>
<td><p>get, set, save</p></td>
<td><p>float</p></td>
<td><p>degC</p></td>
<td><p>Over temperature lock out. Derating of the motor end at this temperature, where the motor is fully disabled.</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>derate</p></td>
<td><p>get</p></td>
<td><p>float</p></td>
<td><p>PU</p></td>
<td><p>Amount of derating applied to motor [0 1]</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="vertiq_8108_150.html" class="btn btn-neutral float-right" title="Vertiq 8108 150KV | Speed Module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="vertiq_2306_2200.html" class="btn btn-neutral float-left" title="Vertiq 2306 2200KV | Speed Module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, IQ Motion Control.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>